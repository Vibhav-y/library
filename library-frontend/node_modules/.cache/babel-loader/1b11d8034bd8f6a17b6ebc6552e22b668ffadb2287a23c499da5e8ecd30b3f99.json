{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vibhav\\\\Desktop\\\\library\\\\library-frontend\\\\src\\\\components\\\\Documents.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { documentAPI, categoryAPI } from '../services/api';\nimport { FileText, Search, ChevronDown, ChevronRight, Folder, FolderOpen, Eye, X, Star } from 'lucide-react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Documents = () => {\n  _s();\n  const [documents, setDocuments] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [expandedCategories, setExpandedCategories] = useState(new Set());\n  const [categoryTree, setCategoryTree] = useState([]);\n  const [categorizedDocuments, setCategorizedDocuments] = useState({});\n  const [selectedDocument, setSelectedDocument] = useState(null);\n  const [viewerLoading, setViewerLoading] = useState(false);\n  const [userFavorites, setUserFavorites] = useState(new Set());\n  const {\n    user\n  } = useAuth();\n  useEffect(() => {\n    loadData();\n  }, []);\n  useEffect(() => {\n    if (categories.length > 0 && documents.length > 0) {\n      organizeCategoriesAndDocuments();\n    }\n  }, [categories, documents, searchTerm]);\n\n  // Disable keyboard shortcuts when viewer is open\n  useEffect(() => {\n    const handleGlobalKeyDown = e => {\n      if (selectedDocument) {\n        // Disable Ctrl+S (Save), Ctrl+P (Print), F12 (DevTools)\n        if (e.ctrlKey && (e.key === 's' || e.key === 'p')) {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n        if (e.key === 'F12' || e.ctrlKey && e.shiftKey && e.key === 'I') {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n      }\n    };\n    if (selectedDocument) {\n      document.addEventListener('keydown', handleGlobalKeyDown, true);\n      // Disable right-click context menu\n      document.addEventListener('contextmenu', e => e.preventDefault());\n    }\n    return () => {\n      document.removeEventListener('keydown', handleGlobalKeyDown, true);\n      document.removeEventListener('contextmenu', e => e.preventDefault());\n    };\n  }, [selectedDocument]);\n  const loadData = async () => {\n    try {\n      const [docsResponse, categoriesResponse] = await Promise.all([documentAPI.getAll(), categoryAPI.getTree()]);\n      setDocuments(docsResponse);\n      setCategories(categoriesResponse);\n\n      // Load user favorites if student\n      if ((user === null || user === void 0 ? void 0 : user.role) === 'student') {\n        loadUserFavorites();\n      }\n    } catch (error) {\n      console.error('Error loading documents:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const loadUserFavorites = async () => {\n    try {\n      const favorites = await documentAPI.getFavorites();\n      const favoriteIds = new Set(favorites.map(doc => doc._id));\n      setUserFavorites(favoriteIds);\n    } catch (error) {\n      console.error('Error loading user favorites:', error);\n    }\n  };\n  const loadFavorites = async () => {\n    try {\n      const favorites = await documentAPI.getFavorites();\n      setFavoriteDocuments(favorites);\n    } catch (error) {\n      console.error('Error loading favorites:', error);\n    }\n  };\n  const organizeCategoriesAndDocuments = () => {\n    // Use appropriate document list based on active tab\n    const sourceDocuments = activeTab === 'favorites' ? favoriteDocuments : documents;\n\n    // For favorites tab, don't organize by categories - show as flat list\n    if (activeTab === 'favorites') {\n      if (!searchTerm) {\n        // Show all favorites as uncategorized for flat display\n        setCategorizedDocuments({\n          'favorites': sourceDocuments\n        });\n        setCategoryTree([]);\n        return;\n      } else {\n        // Filter favorites by search term\n        const filteredFavorites = sourceDocuments.filter(doc => doc.title.toLowerCase().includes(searchTerm.toLowerCase()));\n        setCategorizedDocuments({\n          'favorites': filteredFavorites\n        });\n        setCategoryTree([]);\n        return;\n      }\n    }\n    if (!searchTerm) {\n      // No search term - show all documents grouped by category\n      const docsByCategory = {};\n      const uncategorizedDocs = [];\n      sourceDocuments.forEach(doc => {\n        if (doc.category && doc.category._id) {\n          if (!docsByCategory[doc.category._id]) {\n            docsByCategory[doc.category._id] = [];\n          }\n          docsByCategory[doc.category._id].push(doc);\n        } else {\n          uncategorizedDocs.push(doc);\n        }\n      });\n      if (uncategorizedDocs.length > 0) {\n        docsByCategory['uncategorized'] = uncategorizedDocs;\n      }\n      setCategorizedDocuments(docsByCategory);\n      setCategoryTree(categories);\n      return;\n    }\n\n    // Search in both documents and categories\n    const searchLower = searchTerm.toLowerCase();\n\n    // Filter documents by title\n    const matchingDocs = sourceDocuments.filter(doc => doc.title.toLowerCase().includes(searchLower));\n\n    // Filter categories by name (including nested categories)\n    const matchingCategoryIds = new Set();\n    const checkCategory = cat => {\n      if (cat.name.toLowerCase().includes(searchLower)) {\n        matchingCategoryIds.add(cat._id);\n        // Also add parent categories to show hierarchy\n        if (cat.parentCategory) {\n          matchingCategoryIds.add(cat.parentCategory);\n        }\n      }\n      if (cat.subcategories) {\n        cat.subcategories.forEach(checkCategory);\n      }\n    };\n    categories.forEach(checkCategory);\n\n    // Get documents from matching categories\n    const docsFromMatchingCategories = sourceDocuments.filter(doc => doc.category && matchingCategoryIds.has(doc.category._id));\n\n    // Combine matching documents and documents from matching categories\n    const allMatchingDocs = [...new Set([...matchingDocs, ...docsFromMatchingCategories])];\n\n    // Group documents by category\n    const docsByCategory = {};\n    const uncategorizedDocs = [];\n    allMatchingDocs.forEach(doc => {\n      if (doc.category && doc.category._id) {\n        if (!docsByCategory[doc.category._id]) {\n          docsByCategory[doc.category._id] = [];\n        }\n        docsByCategory[doc.category._id].push(doc);\n      } else {\n        uncategorizedDocs.push(doc);\n      }\n    });\n\n    // Add uncategorized documents if any match the search\n    const matchingUncategorized = sourceDocuments.filter(doc => !doc.category && doc.title.toLowerCase().includes(searchLower));\n    if (matchingUncategorized.length > 0) {\n      docsByCategory['uncategorized'] = matchingUncategorized;\n    }\n\n    // Filter category tree to only show categories that have matching documents or match the search\n    const filterCategoryTree = cats => {\n      return cats.filter(cat => {\n        const hasMatchingDocs = docsByCategory[cat._id] && docsByCategory[cat._id].length > 0;\n        const matchesSearch = cat.name.toLowerCase().includes(searchLower);\n        const hasMatchingSubcategories = cat.subcategories && filterCategoryTree(cat.subcategories).length > 0;\n        if (hasMatchingDocs || matchesSearch || hasMatchingSubcategories) {\n          // Filter subcategories recursively\n          if (cat.subcategories) {\n            cat.subcategories = filterCategoryTree(cat.subcategories);\n          }\n          return true;\n        }\n        return false;\n      });\n    };\n    const filteredCategoryTree = filterCategoryTree([...categories]);\n    setCategorizedDocuments(docsByCategory);\n    setCategoryTree(filteredCategoryTree);\n  };\n  const toggleCategory = categoryId => {\n    const newExpanded = new Set(expandedCategories);\n    if (newExpanded.has(categoryId)) {\n      newExpanded.delete(categoryId);\n    } else {\n      newExpanded.add(categoryId);\n    }\n    setExpandedCategories(newExpanded);\n  };\n  const handleViewDocument = async document => {\n    setViewerLoading(true);\n    setSelectedDocument(document);\n    setViewerLoading(false);\n  };\n  const toggleFavorite = async (documentId, event) => {\n    event.stopPropagation(); // Prevent triggering parent click events\n\n    try {\n      if (userFavorites.has(documentId)) {\n        await documentAPI.removeFromFavorites(documentId);\n        setUserFavorites(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(documentId);\n          return newSet;\n        });\n\n        // If we're in favorites tab, reload favorites\n        if (activeTab === 'favorites') {\n          loadFavorites();\n        }\n      } else {\n        await documentAPI.addToFavorites(documentId);\n        setUserFavorites(prev => new Set([...prev, documentId]));\n      }\n    } catch (error) {\n      console.error('Error toggling favorite:', error);\n    }\n  };\n  const closeViewer = () => {\n    setSelectedDocument(null);\n  };\n  const getDocumentUrl = filePath => {\n    return documentAPI.download(filePath);\n  };\n  const getFileExtension = filePath => {\n    // Extract filename from path and get extension\n    const filename = filePath.split(/[\\\\/]/).pop(); // Handle both forward and back slashes\n    return filename.split('.').pop().toLowerCase();\n  };\n  const renderDocumentViewer = () => {\n    if (!selectedDocument) return null;\n    const fileExtension = getFileExtension(selectedDocument.filePath);\n    const documentUrl = getDocumentUrl(selectedDocument.filePath);\n\n    // Disable keyboard shortcuts for print/save\n    const handleKeyDown = e => {\n      if (e.ctrlKey && (e.key === 's' || e.key === 'p')) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n      if (e.key === 'F12' || e.ctrlKey && e.shiftKey && e.key === 'I') {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",\n      onKeyDown: handleKeyDown,\n      tabIndex: -1,\n      style: {\n        outline: 'none'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-xl w-full h-full max-w-6xl max-h-full flex flex-col\",\n        style: {\n          WebkitUserSelect: 'none',\n          MozUserSelect: 'none',\n          msUserSelect: 'none',\n          userSelect: 'none'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between p-4 border-b\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3\",\n            children: [/*#__PURE__*/_jsxDEV(FileText, {\n              className: \"h-6 w-6 text-blue-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-medium text-gray-900\",\n                children: selectedDocument.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-gray-500\",\n                children: [\"Uploaded on \", new Date(selectedDocument.createdAt).toLocaleDateString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: closeViewer,\n            className: \"p-2 hover:bg-gray-100 rounded-full\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"h-6 w-6 text-gray-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 overflow-hidden\",\n          children: viewerLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-center h-full\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-full w-full\",\n            children: ['pdf'].includes(fileExtension) ? /*#__PURE__*/_jsxDEV(\"iframe\", {\n              src: `${documentUrl}#toolbar=0&navpanes=0&scrollbar=1&view=FitH`,\n              className: \"w-full h-full border-0\",\n              title: selectedDocument.title,\n              style: {\n                userSelect: 'none',\n                WebkitUserSelect: 'none',\n                MozUserSelect: 'none',\n                msUserSelect: 'none'\n              },\n              onLoad: e => {\n                var _e$target$contentDocu, _e$target$contentDocu2;\n                // Disable right-click context menu\n                (_e$target$contentDocu = e.target.contentDocument) === null || _e$target$contentDocu === void 0 ? void 0 : _e$target$contentDocu.addEventListener('contextmenu', event => {\n                  event.preventDefault();\n                });\n                // Disable keyboard shortcuts\n                (_e$target$contentDocu2 = e.target.contentDocument) === null || _e$target$contentDocu2 === void 0 ? void 0 : _e$target$contentDocu2.addEventListener('keydown', event => {\n                  if (event.ctrlKey && (event.key === 's' || event.key === 'p')) {\n                    event.preventDefault();\n                  }\n                });\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 20\n            }, this) : ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp'].includes(fileExtension) ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-full flex items-center justify-center bg-gray-50 overflow-auto\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: documentUrl,\n                alt: selectedDocument.title,\n                className: \"max-w-full max-h-full object-contain\",\n                style: {\n                  userSelect: 'none',\n                  WebkitUserSelect: 'none',\n                  MozUserSelect: 'none',\n                  msUserSelect: 'none'\n                },\n                onContextMenu: e => e.preventDefault(),\n                draggable: false\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 368,\n                columnNumber: 22\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 20\n            }, this) : ['txt', 'md', 'csv'].includes(fileExtension) ? /*#__PURE__*/_jsxDEV(\"iframe\", {\n              src: documentUrl,\n              className: \"w-full h-full border-0\",\n              title: selectedDocument.title,\n              style: {\n                userSelect: 'none',\n                WebkitUserSelect: 'none',\n                MozUserSelect: 'none',\n                msUserSelect: 'none'\n              },\n              onLoad: e => {\n                var _e$target$contentDocu3, _e$target$contentDocu4;\n                // Disable right-click context menu\n                (_e$target$contentDocu3 = e.target.contentDocument) === null || _e$target$contentDocu3 === void 0 ? void 0 : _e$target$contentDocu3.addEventListener('contextmenu', event => {\n                  event.preventDefault();\n                });\n                // Disable keyboard shortcuts\n                (_e$target$contentDocu4 = e.target.contentDocument) === null || _e$target$contentDocu4 === void 0 ? void 0 : _e$target$contentDocu4.addEventListener('keydown', event => {\n                  if (event.ctrlKey && (event.key === 's' || event.key === 'p')) {\n                    event.preventDefault();\n                  }\n                });\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 20\n            }, this) : ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'].includes(fileExtension) ? /*#__PURE__*/_jsxDEV(\"iframe\", {\n              src: `https://docs.google.com/viewer?url=${encodeURIComponent(documentUrl)}&embedded=true&chrome=false&dov=1`,\n              className: \"w-full h-full border-0\",\n              title: selectedDocument.title,\n              style: {\n                userSelect: 'none',\n                WebkitUserSelect: 'none',\n                MozUserSelect: 'none',\n                msUserSelect: 'none'\n              },\n              onLoad: e => {\n                var _e$target$contentDocu5;\n                // Disable right-click context menu\n                (_e$target$contentDocu5 = e.target.contentDocument) === null || _e$target$contentDocu5 === void 0 ? void 0 : _e$target$contentDocu5.addEventListener('contextmenu', event => {\n                  event.preventDefault();\n                });\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 407,\n              columnNumber: 20\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-full flex items-center justify-center bg-gray-50\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center\",\n                children: [/*#__PURE__*/_jsxDEV(FileText, {\n                  className: \"h-16 w-16 text-gray-400 mx-auto mb-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 427,\n                  columnNumber: 24\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-medium text-gray-900 mb-2\",\n                  children: \"Preview not available\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 428,\n                  columnNumber: 24\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-gray-500\",\n                  children: [\"This file type (\", fileExtension, \") cannot be previewed directly.\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 431,\n                  columnNumber: 24\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 426,\n                columnNumber: 22\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 20\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 30\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 7\n    }, this);\n  };\n  const highlightText = (text, searchTerm) => {\n    if (!searchTerm) return text;\n    const parts = text.split(new RegExp(`(${searchTerm})`, 'gi'));\n    return parts.map((part, index) => part.toLowerCase() === searchTerm.toLowerCase() ? /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"bg-yellow-200 font-semibold\",\n      children: part\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 9\n    }, this) : part);\n  };\n  const renderCategory = (category, level = 0) => {\n    const isExpanded = expandedCategories.has(category._id);\n    const hasDocuments = categorizedDocuments[category._id] && categorizedDocuments[category._id].length > 0;\n    const hasSubcategories = category.subcategories && category.subcategories.length > 0;\n    const hasContent = hasDocuments || hasSubcategories;\n    const matchesSearch = searchTerm && category.name.toLowerCase().includes(searchTerm.toLowerCase());\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-l-2 border-gray-200\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex items-center py-2 px-4 hover:bg-gray-50 cursor-pointer ${matchesSearch ? 'bg-yellow-50' : level === 0 ? 'bg-gray-100' : level === 1 ? 'bg-gray-50' : 'bg-white'}`,\n        style: {\n          paddingLeft: `${16 + level * 24}px`\n        },\n        onClick: () => hasContent && toggleCategory(category._id),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2 flex-1\",\n          children: [hasContent ? isExpanded ? /*#__PURE__*/_jsxDEV(ChevronDown, {\n            className: \"h-4 w-4 text-gray-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(ChevronRight, {\n            className: \"h-4 w-4 text-gray-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 478,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 481,\n            columnNumber: 15\n          }, this), isExpanded ? /*#__PURE__*/_jsxDEV(FolderOpen, {\n            className: \"h-5 w-5 text-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(Folder, {\n            className: \"h-5 w-5 text-gray-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: `font-medium ${level === 0 ? 'text-gray-900' : level === 1 ? 'text-gray-800' : 'text-gray-700'}`,\n            children: highlightText(category.name, searchTerm)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 490,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 473,\n          columnNumber: 11\n        }, this), hasDocuments && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\",\n          children: categorizedDocuments[category._id].length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 9\n      }, this), isExpanded && hasContent && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ml-4\",\n        children: [hasDocuments && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-1 mb-2\",\n          children: categorizedDocuments[category._id].map(document => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between py-2 px-4 hover:bg-blue-50 rounded-md mx-2\",\n            style: {\n              paddingLeft: `${16 + (level + 1) * 24}px`\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-3 flex-1\",\n              children: [/*#__PURE__*/_jsxDEV(FileText, {\n                className: \"h-4 w-4 text-blue-600\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 516,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm font-medium text-blue-600 truncate\",\n                  children: highlightText(document.title, searchTerm)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 518,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-500\",\n                  children: new Date(document.createdAt).toLocaleDateString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 521,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 517,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 515,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [(user === null || user === void 0 ? void 0 : user.role) === 'student' && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: e => toggleFavorite(document._id, e),\n                className: \"p-1 hover:bg-gray-100 rounded-full\",\n                title: userFavorites.has(document._id) ? 'Remove from favorites' : 'Add to favorites',\n                children: /*#__PURE__*/_jsxDEV(Star, {\n                  className: `h-4 w-4 ${userFavorites.has(document._id) ? 'text-yellow-500 fill-yellow-500' : 'text-gray-400 hover:text-yellow-500'}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 533,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 528,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleViewDocument(document),\n                className: \"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\",\n                children: [/*#__PURE__*/_jsxDEV(Eye, {\n                  className: \"h-3 w-3 mr-1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 546,\n                  columnNumber: 25\n                }, this), \"View\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 542,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 526,\n              columnNumber: 21\n            }, this)]\n          }, document._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 510,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 508,\n          columnNumber: 15\n        }, this), hasSubcategories && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: category.subcategories.map(subcategory => renderCategory(subcategory, level + 1))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 11\n      }, this)]\n    }, category._id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 7\n    }, this);\n  };\n  const renderFavoritesList = () => {\n    const favoriteDocs = categorizedDocuments['favorites'];\n    if (!favoriteDocs || favoriteDocs.length === 0) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-1\",\n      children: favoriteDocs.map(document => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between py-3 px-4 hover:bg-blue-50 rounded-md border border-gray-200\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-3 flex-1\",\n          children: [/*#__PURE__*/_jsxDEV(FileText, {\n            className: \"h-5 w-5 text-blue-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm font-medium text-blue-600 truncate\",\n              children: highlightText(document.title, searchTerm)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 583,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2 text-xs text-gray-500\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: new Date(document.createdAt).toLocaleDateString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 587,\n                columnNumber: 19\n              }, this), document.category && /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"\\u2022\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 590,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"px-2 py-0.5 bg-gray-100 rounded-full\",\n                  children: document.category.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 591,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 586,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 582,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: e => toggleFavorite(document._id, e),\n            className: \"p-1 hover:bg-gray-100 rounded-full\",\n            title: \"Remove from favorites\",\n            children: /*#__PURE__*/_jsxDEV(Star, {\n              className: \"h-4 w-4 text-yellow-500 fill-yellow-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 605,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 600,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleViewDocument(document),\n            className: \"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\",\n            children: [/*#__PURE__*/_jsxDEV(Eye, {\n              className: \"h-3 w-3 mr-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 611,\n              columnNumber: 17\n            }, this), \"View\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 607,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 599,\n          columnNumber: 13\n        }, this)]\n      }, document._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 576,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 574,\n      columnNumber: 7\n    }, this);\n  };\n  const renderUncategorizedDocuments = () => {\n    const uncategorizedDocs = categorizedDocuments['uncategorized'];\n    if (!uncategorizedDocs || uncategorizedDocs.length === 0) return null;\n    const isExpanded = expandedCategories.has('uncategorized');\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-l-2 border-gray-200\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center py-2 px-4 hover:bg-gray-50 cursor-pointer bg-gray-100\",\n        onClick: () => toggleCategory('uncategorized'),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2 flex-1\",\n          children: [isExpanded ? /*#__PURE__*/_jsxDEV(ChevronDown, {\n            className: \"h-4 w-4 text-gray-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 635,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(ChevronRight, {\n            className: \"h-4 w-4 text-gray-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 637,\n            columnNumber: 15\n          }, this), isExpanded ? /*#__PURE__*/_jsxDEV(FolderOpen, {\n            className: \"h-5 w-5 text-gray-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 641,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(Folder, {\n            className: \"h-5 w-5 text-gray-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 643,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium text-gray-900\",\n            children: \"Uncategorized\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 646,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 633,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800\",\n          children: uncategorizedDocs.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 651,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 629,\n        columnNumber: 9\n      }, this), isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ml-4 space-y-1 mb-2\",\n        children: uncategorizedDocs.map(document => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between py-2 px-4 hover:bg-blue-50 rounded-md mx-2\",\n          style: {\n            paddingLeft: '40px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3 flex-1\",\n            children: [/*#__PURE__*/_jsxDEV(FileText, {\n              className: \"h-4 w-4 text-blue-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 665,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm font-medium text-blue-600 truncate\",\n                children: highlightText(document.title, searchTerm)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 667,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-500\",\n                children: new Date(document.createdAt).toLocaleDateString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 670,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 666,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 664,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-2\",\n            children: [(user === null || user === void 0 ? void 0 : user.role) === 'student' && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: e => toggleFavorite(document._id, e),\n              className: \"p-1 hover:bg-gray-100 rounded-full\",\n              title: userFavorites.has(document._id) ? 'Remove from favorites' : 'Add to favorites',\n              children: /*#__PURE__*/_jsxDEV(Star, {\n                className: `h-4 w-4 ${userFavorites.has(document._id) ? 'text-yellow-500 fill-yellow-500' : 'text-gray-400 hover:text-yellow-500'}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 682,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 677,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleViewDocument(document),\n              className: \"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\",\n              children: [/*#__PURE__*/_jsxDEV(Eye, {\n                className: \"h-3 w-3 mr-1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 695,\n                columnNumber: 21\n              }, this), \"View\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 691,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 675,\n            columnNumber: 17\n          }, this)]\n        }, document._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 659,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 657,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 628,\n      columnNumber: 7\n    }, this);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center h-64\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 710,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 709,\n      columnNumber: 7\n    }, this);\n  }\n  const getTotalMatchingDocuments = () => {\n    const sourceDocuments = activeTab === 'favorites' ? favoriteDocuments : documents;\n    if (!searchTerm) return sourceDocuments.length;\n    const searchLower = searchTerm.toLowerCase();\n\n    // Documents matching by title\n    const matchingDocs = sourceDocuments.filter(doc => doc.title.toLowerCase().includes(searchLower));\n\n    // Documents from matching categories\n    const matchingCategoryIds = new Set();\n    const checkCategory = cat => {\n      if (cat.name.toLowerCase().includes(searchLower)) {\n        matchingCategoryIds.add(cat._id);\n      }\n      if (cat.subcategories) {\n        cat.subcategories.forEach(checkCategory);\n      }\n    };\n    categories.forEach(checkCategory);\n    const docsFromMatchingCategories = sourceDocuments.filter(doc => doc.category && matchingCategoryIds.has(doc.category._id));\n\n    // Combine and deduplicate\n    const allMatchingDocs = [...new Set([...matchingDocs, ...docsFromMatchingCategories])];\n    return allMatchingDocs.length;\n  };\n  const totalDocuments = getTotalMatchingDocuments();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow rounded-lg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-4 py-5 sm:p-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg leading-6 font-medium text-gray-900\",\n          children: \"Document Library\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 754,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-1 text-sm text-gray-500\",\n          children: \"Browse and view documents organized by categories. Click on categories to expand and view documents.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 757,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 753,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 752,\n      columnNumber: 7\n    }, this), (user === null || user === void 0 ? void 0 : user.role) === 'student' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow rounded-lg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-4 py-3 sm:px-6\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveTab('all'),\n            className: `px-3 py-2 text-sm font-medium rounded-md ${activeTab === 'all' ? 'bg-blue-100 text-blue-700' : 'text-gray-500 hover:text-gray-700'}`,\n            children: \"All Documents\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 768,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveTab('favorites'),\n            className: `px-3 py-2 text-sm font-medium rounded-md flex items-center space-x-2 ${activeTab === 'favorites' ? 'bg-blue-100 text-blue-700' : 'text-gray-500 hover:text-gray-700'}`,\n            children: [/*#__PURE__*/_jsxDEV(Star, {\n              className: \"h-4 w-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 786,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Favorites\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 787,\n              columnNumber: 17\n            }, this), userFavorites.size > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800\",\n              children: userFavorites.size\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 789,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 778,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 767,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 766,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 765,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow rounded-lg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-4 py-5 sm:p-6\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"search\",\n            className: \"block text-sm font-medium text-gray-700\",\n            children: \"Search Documents & Categories\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 803,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-1 relative rounded-md shadow-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\",\n              children: /*#__PURE__*/_jsxDEV(Search, {\n                className: \"h-5 w-5 text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 808,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 807,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              id: \"search\",\n              value: searchTerm,\n              onChange: e => setSearchTerm(e.target.value),\n              className: \"focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md\",\n              placeholder: \"Search by document title or category name...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 810,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 806,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mt-1 text-xs text-gray-500\",\n            children: \"Search will find documents by title and categories by name, showing all documents within matching categories.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 819,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 802,\n          columnNumber: 23\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 801,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 800,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow rounded-lg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-4 py-3 sm:px-6 flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-700\",\n          children: searchTerm ? `Found ${totalDocuments} ${activeTab === 'favorites' ? 'favorite ' : ''}documents matching \"${searchTerm}\"` : `${totalDocuments} ${activeTab === 'favorites' ? 'favorite ' : ''}documents available`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 829,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setExpandedCategories(new Set()),\n            className: \"text-sm text-gray-500 hover:text-gray-700\",\n            children: \"Collapse All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 836,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => {\n              const allIds = new Set();\n              const addIds = cats => {\n                cats.forEach(cat => {\n                  var _cat$subcategories;\n                  if (categorizedDocuments[cat._id] || ((_cat$subcategories = cat.subcategories) === null || _cat$subcategories === void 0 ? void 0 : _cat$subcategories.length) > 0) {\n                    allIds.add(cat._id);\n                  }\n                  if (cat.subcategories) {\n                    addIds(cat.subcategories);\n                  }\n                });\n              };\n              addIds(categoryTree);\n              if (categorizedDocuments['uncategorized']) {\n                allIds.add('uncategorized');\n              }\n              setExpandedCategories(allIds);\n            },\n            className: \"text-sm text-blue-600 hover:text-blue-800\",\n            children: \"Expand All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 842,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 835,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 828,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 827,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow overflow-hidden sm:rounded-md\",\n      children: activeTab === 'favorites' ?\n      // Favorites flat list view\n      categorizedDocuments['favorites'] && categorizedDocuments['favorites'].length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4\",\n        children: renderFavoritesList()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 874,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-12\",\n        children: [/*#__PURE__*/_jsxDEV(Star, {\n          className: \"mx-auto h-12 w-12 text-gray-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 879,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"mt-2 text-sm font-medium text-gray-900\",\n          children: \"No favorite documents\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 880,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-1 text-sm text-gray-500\",\n          children: searchTerm ? 'No favorite documents match your search criteria.' : 'Start adding documents to your favorites by clicking the star icon.'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 881,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 878,\n        columnNumber: 13\n      }, this) :\n      // Regular category tree view\n      categoryTree.length > 0 || categorizedDocuments['uncategorized'] ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"divide-y divide-gray-200\",\n        children: [categoryTree.map(category => renderCategory(category)), renderUncategorizedDocuments()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 891,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-12\",\n        children: [/*#__PURE__*/_jsxDEV(FileText, {\n          className: \"mx-auto h-12 w-12 text-gray-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 897,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"mt-2 text-sm font-medium text-gray-900\",\n          children: \"No documents found\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 898,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-1 text-sm text-gray-500\",\n          children: searchTerm ? 'Try adjusting your search criteria.' : 'No documents have been uploaded yet.'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 899,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 896,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 870,\n      columnNumber: 7\n    }, this), renderDocumentViewer()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 750,\n    columnNumber: 5\n  }, this);\n};\n_s(Documents, \"OTpGgjN9KR721kijjQl5CbRQ/Hs=\", false, function () {\n  return [useAuth];\n});\n_c = Documents;\nexport default Documents;\nvar _c;\n$RefreshReg$(_c, \"Documents\");","map":{"version":3,"names":["React","useState","useEffect","documentAPI","categoryAPI","FileText","Search","ChevronDown","ChevronRight","Folder","FolderOpen","Eye","X","Star","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","Documents","_s","documents","setDocuments","categories","setCategories","loading","setLoading","searchTerm","setSearchTerm","expandedCategories","setExpandedCategories","Set","categoryTree","setCategoryTree","categorizedDocuments","setCategorizedDocuments","selectedDocument","setSelectedDocument","viewerLoading","setViewerLoading","userFavorites","setUserFavorites","user","loadData","length","organizeCategoriesAndDocuments","handleGlobalKeyDown","e","ctrlKey","key","preventDefault","stopPropagation","shiftKey","document","addEventListener","removeEventListener","docsResponse","categoriesResponse","Promise","all","getAll","getTree","role","loadUserFavorites","error","console","favorites","getFavorites","favoriteIds","map","doc","_id","loadFavorites","setFavoriteDocuments","sourceDocuments","activeTab","favoriteDocuments","filteredFavorites","filter","title","toLowerCase","includes","docsByCategory","uncategorizedDocs","forEach","category","push","searchLower","matchingDocs","matchingCategoryIds","checkCategory","cat","name","add","parentCategory","subcategories","docsFromMatchingCategories","has","allMatchingDocs","matchingUncategorized","filterCategoryTree","cats","hasMatchingDocs","matchesSearch","hasMatchingSubcategories","filteredCategoryTree","toggleCategory","categoryId","newExpanded","delete","handleViewDocument","toggleFavorite","documentId","event","removeFromFavorites","prev","newSet","addToFavorites","closeViewer","getDocumentUrl","filePath","download","getFileExtension","filename","split","pop","renderDocumentViewer","fileExtension","documentUrl","handleKeyDown","className","onKeyDown","tabIndex","style","outline","children","WebkitUserSelect","MozUserSelect","msUserSelect","userSelect","fileName","_jsxFileName","lineNumber","columnNumber","Date","createdAt","toLocaleDateString","onClick","src","onLoad","_e$target$contentDocu","_e$target$contentDocu2","target","contentDocument","alt","onContextMenu","draggable","_e$target$contentDocu3","_e$target$contentDocu4","encodeURIComponent","_e$target$contentDocu5","highlightText","text","parts","RegExp","part","index","renderCategory","level","isExpanded","hasDocuments","hasSubcategories","hasContent","paddingLeft","subcategory","renderFavoritesList","favoriteDocs","renderUncategorizedDocuments","getTotalMatchingDocuments","totalDocuments","setActiveTab","size","htmlFor","type","id","value","onChange","placeholder","allIds","addIds","_cat$subcategories","_c","$RefreshReg$"],"sources":["C:/Users/vibhav/Desktop/library/library-frontend/src/components/Documents.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { documentAPI, categoryAPI } from '../services/api';\r\nimport { FileText, Search, ChevronDown, ChevronRight, Folder, FolderOpen, Eye, X, Star } from 'lucide-react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\nconst Documents = () => {\r\n  const [documents, setDocuments] = useState([]);\r\n  const [categories, setCategories] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [expandedCategories, setExpandedCategories] = useState(new Set());\r\n  const [categoryTree, setCategoryTree] = useState([]);\r\n  const [categorizedDocuments, setCategorizedDocuments] = useState({});\r\n  const [selectedDocument, setSelectedDocument] = useState(null);\r\n  const [viewerLoading, setViewerLoading] = useState(false);\r\n  const [userFavorites, setUserFavorites] = useState(new Set());\r\n  \r\n  const { user } = useAuth();\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (categories.length > 0 && documents.length > 0) {\r\n      organizeCategoriesAndDocuments();\r\n    }\r\n  }, [categories, documents, searchTerm]);\r\n\r\n  // Disable keyboard shortcuts when viewer is open\r\n  useEffect(() => {\r\n    const handleGlobalKeyDown = (e) => {\r\n      if (selectedDocument) {\r\n        // Disable Ctrl+S (Save), Ctrl+P (Print), F12 (DevTools)\r\n        if (e.ctrlKey && (e.key === 's' || e.key === 'p')) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n        }\r\n        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n        }\r\n      }\r\n    };\r\n\r\n    if (selectedDocument) {\r\n      document.addEventListener('keydown', handleGlobalKeyDown, true);\r\n      // Disable right-click context menu\r\n      document.addEventListener('contextmenu', (e) => e.preventDefault());\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleGlobalKeyDown, true);\r\n      document.removeEventListener('contextmenu', (e) => e.preventDefault());\r\n    };\r\n  }, [selectedDocument]);\r\n\r\n  const loadData = async () => {\r\n    try {\r\n      const [docsResponse, categoriesResponse] = await Promise.all([\r\n        documentAPI.getAll(),\r\n        categoryAPI.getTree(),\r\n      ]);\r\n      \r\n      setDocuments(docsResponse);\r\n      setCategories(categoriesResponse);\r\n      \r\n      // Load user favorites if student\r\n      if (user?.role === 'student') {\r\n        loadUserFavorites();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading documents:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadUserFavorites = async () => {\r\n    try {\r\n      const favorites = await documentAPI.getFavorites();\r\n      const favoriteIds = new Set(favorites.map(doc => doc._id));\r\n      setUserFavorites(favoriteIds);\r\n    } catch (error) {\r\n      console.error('Error loading user favorites:', error);\r\n    }\r\n  };\r\n\r\n  const loadFavorites = async () => {\r\n    try {\r\n      const favorites = await documentAPI.getFavorites();\r\n      setFavoriteDocuments(favorites);\r\n    } catch (error) {\r\n      console.error('Error loading favorites:', error);\r\n    }\r\n  };\r\n\r\n  const organizeCategoriesAndDocuments = () => {\r\n    // Use appropriate document list based on active tab\r\n    const sourceDocuments = activeTab === 'favorites' ? favoriteDocuments : documents;\r\n    \r\n    // For favorites tab, don't organize by categories - show as flat list\r\n    if (activeTab === 'favorites') {\r\n      if (!searchTerm) {\r\n        // Show all favorites as uncategorized for flat display\r\n        setCategorizedDocuments({ 'favorites': sourceDocuments });\r\n        setCategoryTree([]);\r\n        return;\r\n      } else {\r\n        // Filter favorites by search term\r\n        const filteredFavorites = sourceDocuments.filter(doc =>\r\n          doc.title.toLowerCase().includes(searchTerm.toLowerCase())\r\n        );\r\n        setCategorizedDocuments({ 'favorites': filteredFavorites });\r\n        setCategoryTree([]);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    if (!searchTerm) {\r\n      // No search term - show all documents grouped by category\r\n      const docsByCategory = {};\r\n      const uncategorizedDocs = [];\r\n\r\n      sourceDocuments.forEach(doc => {\r\n        if (doc.category && doc.category._id) {\r\n          if (!docsByCategory[doc.category._id]) {\r\n            docsByCategory[doc.category._id] = [];\r\n          }\r\n          docsByCategory[doc.category._id].push(doc);\r\n        } else {\r\n          uncategorizedDocs.push(doc);\r\n        }\r\n      });\r\n\r\n      if (uncategorizedDocs.length > 0) {\r\n        docsByCategory['uncategorized'] = uncategorizedDocs;\r\n      }\r\n\r\n      setCategorizedDocuments(docsByCategory);\r\n      setCategoryTree(categories);\r\n      return;\r\n    }\r\n\r\n    // Search in both documents and categories\r\n    const searchLower = searchTerm.toLowerCase();\r\n    \r\n    // Filter documents by title\r\n    const matchingDocs = sourceDocuments.filter(doc =>\r\n      doc.title.toLowerCase().includes(searchLower)\r\n    );\r\n\r\n    // Filter categories by name (including nested categories)\r\n    const matchingCategoryIds = new Set();\r\n    const checkCategory = (cat) => {\r\n      if (cat.name.toLowerCase().includes(searchLower)) {\r\n        matchingCategoryIds.add(cat._id);\r\n        // Also add parent categories to show hierarchy\r\n        if (cat.parentCategory) {\r\n          matchingCategoryIds.add(cat.parentCategory);\r\n        }\r\n      }\r\n      if (cat.subcategories) {\r\n        cat.subcategories.forEach(checkCategory);\r\n      }\r\n    };\r\n    categories.forEach(checkCategory);\r\n\r\n    // Get documents from matching categories\r\n    const docsFromMatchingCategories = sourceDocuments.filter(doc => \r\n      doc.category && matchingCategoryIds.has(doc.category._id)\r\n    );\r\n\r\n    // Combine matching documents and documents from matching categories\r\n    const allMatchingDocs = [...new Set([...matchingDocs, ...docsFromMatchingCategories])];\r\n\r\n    // Group documents by category\r\n    const docsByCategory = {};\r\n    const uncategorizedDocs = [];\r\n\r\n    allMatchingDocs.forEach(doc => {\r\n      if (doc.category && doc.category._id) {\r\n        if (!docsByCategory[doc.category._id]) {\r\n          docsByCategory[doc.category._id] = [];\r\n        }\r\n        docsByCategory[doc.category._id].push(doc);\r\n      } else {\r\n        uncategorizedDocs.push(doc);\r\n      }\r\n    });\r\n\r\n    // Add uncategorized documents if any match the search\r\n    const matchingUncategorized = sourceDocuments.filter(doc => \r\n      !doc.category && doc.title.toLowerCase().includes(searchLower)\r\n    );\r\n    if (matchingUncategorized.length > 0) {\r\n      docsByCategory['uncategorized'] = matchingUncategorized;\r\n    }\r\n\r\n    // Filter category tree to only show categories that have matching documents or match the search\r\n    const filterCategoryTree = (cats) => {\r\n      return cats.filter(cat => {\r\n        const hasMatchingDocs = docsByCategory[cat._id] && docsByCategory[cat._id].length > 0;\r\n        const matchesSearch = cat.name.toLowerCase().includes(searchLower);\r\n        const hasMatchingSubcategories = cat.subcategories && filterCategoryTree(cat.subcategories).length > 0;\r\n        \r\n        if (hasMatchingDocs || matchesSearch || hasMatchingSubcategories) {\r\n          // Filter subcategories recursively\r\n          if (cat.subcategories) {\r\n            cat.subcategories = filterCategoryTree(cat.subcategories);\r\n          }\r\n          return true;\r\n        }\r\n        return false;\r\n      });\r\n    };\r\n\r\n    const filteredCategoryTree = filterCategoryTree([...categories]);\r\n\r\n    setCategorizedDocuments(docsByCategory);\r\n    setCategoryTree(filteredCategoryTree);\r\n  };\r\n\r\n  const toggleCategory = (categoryId) => {\r\n    const newExpanded = new Set(expandedCategories);\r\n    if (newExpanded.has(categoryId)) {\r\n      newExpanded.delete(categoryId);\r\n    } else {\r\n      newExpanded.add(categoryId);\r\n    }\r\n    setExpandedCategories(newExpanded);\r\n  };\r\n\r\n  const handleViewDocument = async (document) => {\r\n    setViewerLoading(true);\r\n    setSelectedDocument(document);\r\n    setViewerLoading(false);\r\n  };\r\n\r\n  const toggleFavorite = async (documentId, event) => {\r\n    event.stopPropagation(); // Prevent triggering parent click events\r\n    \r\n    try {\r\n      if (userFavorites.has(documentId)) {\r\n        await documentAPI.removeFromFavorites(documentId);\r\n        setUserFavorites(prev => {\r\n          const newSet = new Set(prev);\r\n          newSet.delete(documentId);\r\n          return newSet;\r\n        });\r\n        \r\n        // If we're in favorites tab, reload favorites\r\n        if (activeTab === 'favorites') {\r\n          loadFavorites();\r\n        }\r\n      } else {\r\n        await documentAPI.addToFavorites(documentId);\r\n        setUserFavorites(prev => new Set([...prev, documentId]));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error toggling favorite:', error);\r\n    }\r\n  };\r\n\r\n  const closeViewer = () => {\r\n    setSelectedDocument(null);\r\n  };\r\n\r\n  const getDocumentUrl = (filePath) => {\r\n    return documentAPI.download(filePath);\r\n  };\r\n\r\n  const getFileExtension = (filePath) => {\r\n    // Extract filename from path and get extension\r\n    const filename = filePath.split(/[\\\\/]/).pop(); // Handle both forward and back slashes\r\n    return filename.split('.').pop().toLowerCase();\r\n  };\r\n\r\n  const renderDocumentViewer = () => {\r\n    if (!selectedDocument) return null;\r\n\r\n    const fileExtension = getFileExtension(selectedDocument.filePath);\r\n    const documentUrl = getDocumentUrl(selectedDocument.filePath);\r\n\r\n    // Disable keyboard shortcuts for print/save\r\n    const handleKeyDown = (e) => {\r\n      if (e.ctrlKey && (e.key === 's' || e.key === 'p')) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      }\r\n      if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div \r\n        className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\"\r\n        onKeyDown={handleKeyDown}\r\n        tabIndex={-1}\r\n        style={{ outline: 'none' }}\r\n      >\r\n        <div \r\n          className=\"bg-white rounded-lg shadow-xl w-full h-full max-w-6xl max-h-full flex flex-col\"\r\n          style={{\r\n            WebkitUserSelect: 'none',\r\n            MozUserSelect: 'none',\r\n            msUserSelect: 'none',\r\n            userSelect: 'none'\r\n          }}\r\n        >\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-4 border-b\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <FileText className=\"h-6 w-6 text-blue-600\" />\r\n              <div>\r\n                <h3 className=\"text-lg font-medium text-gray-900\">\r\n                  {selectedDocument.title}\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500\">\r\n                  Uploaded on {new Date(selectedDocument.createdAt).toLocaleDateString()}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <button\r\n              onClick={closeViewer}\r\n              className=\"p-2 hover:bg-gray-100 rounded-full\"\r\n            >\r\n              <X className=\"h-6 w-6 text-gray-500\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Document Content */}\r\n          <div className=\"flex-1 overflow-hidden\">\r\n            {viewerLoading ? (\r\n              <div className=\"flex items-center justify-center h-full\">\r\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"></div>\r\n              </div>\r\n            ) : (\r\n                             <div className=\"h-full w-full\">\r\n                 {['pdf'].includes(fileExtension) ? (\r\n                   <iframe\r\n                     src={`${documentUrl}#toolbar=0&navpanes=0&scrollbar=1&view=FitH`}\r\n                     className=\"w-full h-full border-0\"\r\n                     title={selectedDocument.title}\r\n                     style={{ \r\n                       userSelect: 'none',\r\n                       WebkitUserSelect: 'none',\r\n                       MozUserSelect: 'none',\r\n                       msUserSelect: 'none'\r\n                     }}\r\n                     onLoad={(e) => {\r\n                       // Disable right-click context menu\r\n                       e.target.contentDocument?.addEventListener('contextmenu', (event) => {\r\n                         event.preventDefault();\r\n                       });\r\n                       // Disable keyboard shortcuts\r\n                       e.target.contentDocument?.addEventListener('keydown', (event) => {\r\n                         if (event.ctrlKey && (event.key === 's' || event.key === 'p')) {\r\n                           event.preventDefault();\r\n                         }\r\n                       });\r\n                     }}\r\n                   />\r\n                 ) : ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp'].includes(fileExtension) ? (\r\n                   <div className=\"h-full flex items-center justify-center bg-gray-50 overflow-auto\">\r\n                     <img\r\n                       src={documentUrl}\r\n                       alt={selectedDocument.title}\r\n                       className=\"max-w-full max-h-full object-contain\"\r\n                       style={{ \r\n                         userSelect: 'none',\r\n                         WebkitUserSelect: 'none',\r\n                         MozUserSelect: 'none',\r\n                         msUserSelect: 'none'\r\n                       }}\r\n                       onContextMenu={(e) => e.preventDefault()}\r\n                       draggable={false}\r\n                     />\r\n                   </div>\r\n                 ) : ['txt', 'md', 'csv'].includes(fileExtension) ? (\r\n                   <iframe\r\n                     src={documentUrl}\r\n                     className=\"w-full h-full border-0\"\r\n                     title={selectedDocument.title}\r\n                     style={{ \r\n                       userSelect: 'none',\r\n                       WebkitUserSelect: 'none',\r\n                       MozUserSelect: 'none',\r\n                       msUserSelect: 'none'\r\n                     }}\r\n                     onLoad={(e) => {\r\n                       // Disable right-click context menu\r\n                       e.target.contentDocument?.addEventListener('contextmenu', (event) => {\r\n                         event.preventDefault();\r\n                       });\r\n                       // Disable keyboard shortcuts\r\n                       e.target.contentDocument?.addEventListener('keydown', (event) => {\r\n                         if (event.ctrlKey && (event.key === 's' || event.key === 'p')) {\r\n                           event.preventDefault();\r\n                         }\r\n                       });\r\n                     }}\r\n                   />\r\n                 ) : ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'].includes(fileExtension) ? (\r\n                   <iframe\r\n                     src={`https://docs.google.com/viewer?url=${encodeURIComponent(documentUrl)}&embedded=true&chrome=false&dov=1`}\r\n                     className=\"w-full h-full border-0\"\r\n                     title={selectedDocument.title}\r\n                     style={{ \r\n                       userSelect: 'none',\r\n                       WebkitUserSelect: 'none',\r\n                       MozUserSelect: 'none',\r\n                       msUserSelect: 'none'\r\n                     }}\r\n                     onLoad={(e) => {\r\n                       // Disable right-click context menu\r\n                       e.target.contentDocument?.addEventListener('contextmenu', (event) => {\r\n                         event.preventDefault();\r\n                       });\r\n                     }}\r\n                   />\r\n                 ) : (\r\n                   <div className=\"h-full flex items-center justify-center bg-gray-50\">\r\n                     <div className=\"text-center\">\r\n                       <FileText className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\r\n                       <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                         Preview not available\r\n                       </h3>\r\n                       <p className=\"text-gray-500\">\r\n                         This file type ({fileExtension}) cannot be previewed directly.\r\n                       </p>\r\n                     </div>\r\n                   </div>\r\n                 )}\r\n               </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const highlightText = (text, searchTerm) => {\r\n    if (!searchTerm) return text;\r\n    \r\n    const parts = text.split(new RegExp(`(${searchTerm})`, 'gi'));\r\n    return parts.map((part, index) => \r\n      part.toLowerCase() === searchTerm.toLowerCase() ? \r\n        <span key={index} className=\"bg-yellow-200 font-semibold\">{part}</span> : \r\n        part\r\n    );\r\n  };\r\n\r\n  const renderCategory = (category, level = 0) => {\r\n    const isExpanded = expandedCategories.has(category._id);\r\n    const hasDocuments = categorizedDocuments[category._id] && categorizedDocuments[category._id].length > 0;\r\n    const hasSubcategories = category.subcategories && category.subcategories.length > 0;\r\n    const hasContent = hasDocuments || hasSubcategories;\r\n    const matchesSearch = searchTerm && category.name.toLowerCase().includes(searchTerm.toLowerCase());\r\n\r\n    return (\r\n      <div key={category._id} className=\"border-l-2 border-gray-200\">\r\n        <div \r\n          className={`flex items-center py-2 px-4 hover:bg-gray-50 cursor-pointer ${\r\n            matchesSearch ? 'bg-yellow-50' : \r\n            level === 0 ? 'bg-gray-100' : level === 1 ? 'bg-gray-50' : 'bg-white'\r\n          }`}\r\n          style={{ paddingLeft: `${16 + level * 24}px` }}\r\n          onClick={() => hasContent && toggleCategory(category._id)}\r\n        >\r\n          <div className=\"flex items-center space-x-2 flex-1\">\r\n            {hasContent ? (\r\n              isExpanded ? (\r\n                <ChevronDown className=\"h-4 w-4 text-gray-500\" />\r\n              ) : (\r\n                <ChevronRight className=\"h-4 w-4 text-gray-500\" />\r\n              )\r\n            ) : (\r\n              <div className=\"w-4 h-4\" />\r\n            )}\r\n            \r\n            {isExpanded ? (\r\n              <FolderOpen className=\"h-5 w-5 text-blue-500\" />\r\n            ) : (\r\n              <Folder className=\"h-5 w-5 text-gray-500\" />\r\n            )}\r\n            \r\n            <span className={`font-medium ${\r\n              level === 0 ? 'text-gray-900' : level === 1 ? 'text-gray-800' : 'text-gray-700'\r\n            }`}>\r\n              {highlightText(category.name, searchTerm)}\r\n            </span>\r\n          </div>\r\n          \r\n          {hasDocuments && (\r\n            <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\r\n              {categorizedDocuments[category._id].length}\r\n            </span>\r\n          )}\r\n        </div>\r\n\r\n        {isExpanded && hasContent && (\r\n          <div className=\"ml-4\">\r\n            {/* Render documents for this category */}\r\n            {hasDocuments && (\r\n              <div className=\"space-y-1 mb-2\">\r\n                {categorizedDocuments[category._id].map((document) => (\r\n                  <div \r\n                    key={document._id} \r\n                    className=\"flex items-center justify-between py-2 px-4 hover:bg-blue-50 rounded-md mx-2\"\r\n                    style={{ paddingLeft: `${16 + (level + 1) * 24}px` }}\r\n                  >\r\n                    <div className=\"flex items-center space-x-3 flex-1\">\r\n                      <FileText className=\"h-4 w-4 text-blue-600\" />\r\n                      <div>\r\n                        <p className=\"text-sm font-medium text-blue-600 truncate\">\r\n                          {highlightText(document.title, searchTerm)}\r\n                        </p>\r\n                        <p className=\"text-xs text-gray-500\">\r\n                          {new Date(document.createdAt).toLocaleDateString()}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      {user?.role === 'student' && (\r\n                        <button\r\n                          onClick={(e) => toggleFavorite(document._id, e)}\r\n                          className=\"p-1 hover:bg-gray-100 rounded-full\"\r\n                          title={userFavorites.has(document._id) ? 'Remove from favorites' : 'Add to favorites'}\r\n                        >\r\n                          <Star \r\n                            className={`h-4 w-4 ${\r\n                              userFavorites.has(document._id) \r\n                                ? 'text-yellow-500 fill-yellow-500' \r\n                                : 'text-gray-400 hover:text-yellow-500'\r\n                            }`}\r\n                          />\r\n                        </button>\r\n                      )}\r\n                      <button\r\n                        onClick={() => handleViewDocument(document)}\r\n                        className=\"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                      >\r\n                        <Eye className=\"h-3 w-3 mr-1\" />\r\n                        View\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n\r\n            {/* Render subcategories */}\r\n            {hasSubcategories && (\r\n              <div>\r\n                {category.subcategories.map(subcategory => \r\n                  renderCategory(subcategory, level + 1)\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderFavoritesList = () => {\r\n    const favoriteDocs = categorizedDocuments['favorites'];\r\n    if (!favoriteDocs || favoriteDocs.length === 0) return null;\r\n\r\n    return (\r\n      <div className=\"space-y-1\">\r\n        {favoriteDocs.map((document) => (\r\n          <div \r\n            key={document._id} \r\n            className=\"flex items-center justify-between py-3 px-4 hover:bg-blue-50 rounded-md border border-gray-200\"\r\n          >\r\n            <div className=\"flex items-center space-x-3 flex-1\">\r\n              <FileText className=\"h-5 w-5 text-blue-600\" />\r\n              <div>\r\n                <p className=\"text-sm font-medium text-blue-600 truncate\">\r\n                  {highlightText(document.title, searchTerm)}\r\n                </p>\r\n                <div className=\"flex items-center space-x-2 text-xs text-gray-500\">\r\n                  <span>{new Date(document.createdAt).toLocaleDateString()}</span>\r\n                  {document.category && (\r\n                    <>\r\n                      <span>•</span>\r\n                      <span className=\"px-2 py-0.5 bg-gray-100 rounded-full\">\r\n                        {document.category.name}\r\n                      </span>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center space-x-2\">\r\n              <button\r\n                onClick={(e) => toggleFavorite(document._id, e)}\r\n                className=\"p-1 hover:bg-gray-100 rounded-full\"\r\n                title=\"Remove from favorites\"\r\n              >\r\n                <Star className=\"h-4 w-4 text-yellow-500 fill-yellow-500\" />\r\n              </button>\r\n              <button\r\n                onClick={() => handleViewDocument(document)}\r\n                className=\"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n              >\r\n                <Eye className=\"h-3 w-3 mr-1\" />\r\n                View\r\n              </button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderUncategorizedDocuments = () => {\r\n    const uncategorizedDocs = categorizedDocuments['uncategorized'];\r\n    if (!uncategorizedDocs || uncategorizedDocs.length === 0) return null;\r\n\r\n    const isExpanded = expandedCategories.has('uncategorized');\r\n\r\n    return (\r\n      <div className=\"border-l-2 border-gray-200\">\r\n        <div \r\n          className=\"flex items-center py-2 px-4 hover:bg-gray-50 cursor-pointer bg-gray-100\"\r\n          onClick={() => toggleCategory('uncategorized')}\r\n        >\r\n          <div className=\"flex items-center space-x-2 flex-1\">\r\n            {isExpanded ? (\r\n              <ChevronDown className=\"h-4 w-4 text-gray-500\" />\r\n            ) : (\r\n              <ChevronRight className=\"h-4 w-4 text-gray-500\" />\r\n            )}\r\n            \r\n            {isExpanded ? (\r\n              <FolderOpen className=\"h-5 w-5 text-gray-500\" />\r\n            ) : (\r\n              <Folder className=\"h-5 w-5 text-gray-500\" />\r\n            )}\r\n            \r\n            <span className=\"font-medium text-gray-900\">\r\n              Uncategorized\r\n            </span>\r\n          </div>\r\n          \r\n          <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800\">\r\n            {uncategorizedDocs.length}\r\n          </span>\r\n        </div>\r\n\r\n        {isExpanded && (\r\n          <div className=\"ml-4 space-y-1 mb-2\">\r\n            {uncategorizedDocs.map((document) => (\r\n              <div \r\n                key={document._id} \r\n                className=\"flex items-center justify-between py-2 px-4 hover:bg-blue-50 rounded-md mx-2\"\r\n                style={{ paddingLeft: '40px' }}\r\n              >\r\n                <div className=\"flex items-center space-x-3 flex-1\">\r\n                  <FileText className=\"h-4 w-4 text-blue-600\" />\r\n                  <div>\r\n                    <p className=\"text-sm font-medium text-blue-600 truncate\">\r\n                      {highlightText(document.title, searchTerm)}\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-500\">\r\n                      {new Date(document.createdAt).toLocaleDateString()}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center space-x-2\">\r\n                  {user?.role === 'student' && (\r\n                    <button\r\n                      onClick={(e) => toggleFavorite(document._id, e)}\r\n                      className=\"p-1 hover:bg-gray-100 rounded-full\"\r\n                      title={userFavorites.has(document._id) ? 'Remove from favorites' : 'Add to favorites'}\r\n                    >\r\n                      <Star \r\n                        className={`h-4 w-4 ${\r\n                          userFavorites.has(document._id) \r\n                            ? 'text-yellow-500 fill-yellow-500' \r\n                            : 'text-gray-400 hover:text-yellow-500'\r\n                        }`}\r\n                      />\r\n                    </button>\r\n                  )}\r\n                  <button\r\n                    onClick={() => handleViewDocument(document)}\r\n                    className=\"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                  >\r\n                    <Eye className=\"h-3 w-3 mr-1\" />\r\n                    View\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const getTotalMatchingDocuments = () => {\r\n    const sourceDocuments = activeTab === 'favorites' ? favoriteDocuments : documents;\r\n    if (!searchTerm) return sourceDocuments.length;\r\n    \r\n    const searchLower = searchTerm.toLowerCase();\r\n    \r\n    // Documents matching by title\r\n    const matchingDocs = sourceDocuments.filter(doc =>\r\n      doc.title.toLowerCase().includes(searchLower)\r\n    );\r\n\r\n    // Documents from matching categories\r\n    const matchingCategoryIds = new Set();\r\n    const checkCategory = (cat) => {\r\n      if (cat.name.toLowerCase().includes(searchLower)) {\r\n        matchingCategoryIds.add(cat._id);\r\n      }\r\n      if (cat.subcategories) {\r\n        cat.subcategories.forEach(checkCategory);\r\n      }\r\n    };\r\n    categories.forEach(checkCategory);\r\n\r\n    const docsFromMatchingCategories = sourceDocuments.filter(doc => \r\n      doc.category && matchingCategoryIds.has(doc.category._id)\r\n    );\r\n\r\n    // Combine and deduplicate\r\n    const allMatchingDocs = [...new Set([...matchingDocs, ...docsFromMatchingCategories])];\r\n    return allMatchingDocs.length;\r\n  };\r\n\r\n  const totalDocuments = getTotalMatchingDocuments();\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow rounded-lg\">\r\n        <div className=\"px-4 py-5 sm:p-6\">\r\n          <h3 className=\"text-lg leading-6 font-medium text-gray-900\">\r\n            Document Library\r\n          </h3>\r\n          <p className=\"mt-1 text-sm text-gray-500\">\r\n            Browse and view documents organized by categories. Click on categories to expand and view documents.\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs - Only show for students */}\r\n      {user?.role === 'student' && (\r\n        <div className=\"bg-white shadow rounded-lg\">\r\n          <div className=\"px-4 py-3 sm:px-6\">\r\n            <div className=\"flex space-x-4\">\r\n              <button\r\n                onClick={() => setActiveTab('all')}\r\n                className={`px-3 py-2 text-sm font-medium rounded-md ${\r\n                  activeTab === 'all'\r\n                    ? 'bg-blue-100 text-blue-700'\r\n                    : 'text-gray-500 hover:text-gray-700'\r\n                }`}\r\n              >\r\n                All Documents\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTab('favorites')}\r\n                className={`px-3 py-2 text-sm font-medium rounded-md flex items-center space-x-2 ${\r\n                  activeTab === 'favorites'\r\n                    ? 'bg-blue-100 text-blue-700'\r\n                    : 'text-gray-500 hover:text-gray-700'\r\n                }`}\r\n              >\r\n                <Star className=\"h-4 w-4\" />\r\n                <span>Favorites</span>\r\n                {userFavorites.size > 0 && (\r\n                  <span className=\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800\">\r\n                    {userFavorites.size}\r\n                  </span>\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Search */}\r\n      <div className=\"bg-white shadow rounded-lg\">\r\n        <div className=\"px-4 py-5 sm:p-6\">\r\n                      <div>\r\n              <label htmlFor=\"search\" className=\"block text-sm font-medium text-gray-700\">\r\n                Search Documents & Categories\r\n              </label>\r\n              <div className=\"mt-1 relative rounded-md shadow-sm\">\r\n                <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                  <Search className=\"h-5 w-5 text-gray-400\" />\r\n                </div>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"search\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md\"\r\n                  placeholder=\"Search by document title or category name...\"\r\n                />\r\n              </div>\r\n              <p className=\"mt-1 text-xs text-gray-500\">\r\n                Search will find documents by title and categories by name, showing all documents within matching categories.\r\n              </p>\r\n            </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Results Summary */}\r\n      <div className=\"bg-white shadow rounded-lg\">\r\n        <div className=\"px-4 py-3 sm:px-6 flex items-center justify-between\">\r\n          <p className=\"text-sm text-gray-700\">\r\n            {searchTerm ? \r\n              `Found ${totalDocuments} ${activeTab === 'favorites' ? 'favorite ' : ''}documents matching \"${searchTerm}\"` : \r\n              `${totalDocuments} ${activeTab === 'favorites' ? 'favorite ' : ''}documents available`\r\n            }\r\n          </p>\r\n          <div className=\"flex items-center space-x-4\">\r\n            <button\r\n              onClick={() => setExpandedCategories(new Set())}\r\n              className=\"text-sm text-gray-500 hover:text-gray-700\"\r\n            >\r\n              Collapse All\r\n            </button>\r\n            <button\r\n              onClick={() => {\r\n                const allIds = new Set();\r\n                const addIds = (cats) => {\r\n                  cats.forEach(cat => {\r\n                    if (categorizedDocuments[cat._id] || cat.subcategories?.length > 0) {\r\n                      allIds.add(cat._id);\r\n                    }\r\n                    if (cat.subcategories) {\r\n                      addIds(cat.subcategories);\r\n                    }\r\n                  });\r\n                };\r\n                addIds(categoryTree);\r\n                if (categorizedDocuments['uncategorized']) {\r\n                  allIds.add('uncategorized');\r\n                }\r\n                setExpandedCategories(allIds);\r\n              }}\r\n              className=\"text-sm text-blue-600 hover:text-blue-800\"\r\n            >\r\n              Expand All\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Category Tree or Favorites List */}\r\n      <div className=\"bg-white shadow overflow-hidden sm:rounded-md\">\r\n        {activeTab === 'favorites' ? (\r\n          // Favorites flat list view\r\n          categorizedDocuments['favorites'] && categorizedDocuments['favorites'].length > 0 ? (\r\n            <div className=\"p-4\">\r\n              {renderFavoritesList()}\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-12\">\r\n              <Star className=\"mx-auto h-12 w-12 text-gray-400\" />\r\n              <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No favorite documents</h3>\r\n              <p className=\"mt-1 text-sm text-gray-500\">\r\n                {searchTerm\r\n                  ? 'No favorite documents match your search criteria.'\r\n                  : 'Start adding documents to your favorites by clicking the star icon.'}\r\n              </p>\r\n            </div>\r\n          )\r\n        ) : (\r\n          // Regular category tree view\r\n          categoryTree.length > 0 || categorizedDocuments['uncategorized'] ? (\r\n            <div className=\"divide-y divide-gray-200\">\r\n              {categoryTree.map(category => renderCategory(category))}\r\n              {renderUncategorizedDocuments()}\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-12\">\r\n              <FileText className=\"mx-auto h-12 w-12 text-gray-400\" />\r\n              <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No documents found</h3>\r\n              <p className=\"mt-1 text-sm text-gray-500\">\r\n                {searchTerm\r\n                  ? 'Try adjusting your search criteria.'\r\n                  : 'No documents have been uploaded yet.'}\r\n              </p>\r\n            </div>\r\n          )\r\n        )}\r\n      </div>\r\n\r\n      {/* Document Viewer Modal */}\r\n      {renderDocumentViewer()}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Documents; "],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,WAAW,EAAEC,WAAW,QAAQ,iBAAiB;AAC1D,SAASC,QAAQ,EAAEC,MAAM,EAAEC,WAAW,EAAEC,YAAY,EAAEC,MAAM,EAAEC,UAAU,EAAEC,GAAG,EAAEC,CAAC,EAAEC,IAAI,QAAQ,cAAc;AAC5G,SAASC,OAAO,QAAQ,yBAAyB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAElD,MAAMC,SAAS,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACtB,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGrB,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACsB,UAAU,EAAEC,aAAa,CAAC,GAAGvB,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAACwB,OAAO,EAAEC,UAAU,CAAC,GAAGzB,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAAC0B,UAAU,EAAEC,aAAa,CAAC,GAAG3B,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAAC4B,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG7B,QAAQ,CAAC,IAAI8B,GAAG,CAAC,CAAC,CAAC;EACvE,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGhC,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAACiC,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGlC,QAAQ,CAAC,CAAC,CAAC,CAAC;EACpE,MAAM,CAACmC,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGpC,QAAQ,CAAC,IAAI,CAAC;EAC9D,MAAM,CAACqC,aAAa,EAAEC,gBAAgB,CAAC,GAAGtC,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAM,CAACuC,aAAa,EAAEC,gBAAgB,CAAC,GAAGxC,QAAQ,CAAC,IAAI8B,GAAG,CAAC,CAAC,CAAC;EAE7D,MAAM;IAAEW;EAAK,CAAC,GAAG5B,OAAO,CAAC,CAAC;EAE1BZ,SAAS,CAAC,MAAM;IACdyC,QAAQ,CAAC,CAAC;EACZ,CAAC,EAAE,EAAE,CAAC;EAENzC,SAAS,CAAC,MAAM;IACd,IAAIqB,UAAU,CAACqB,MAAM,GAAG,CAAC,IAAIvB,SAAS,CAACuB,MAAM,GAAG,CAAC,EAAE;MACjDC,8BAA8B,CAAC,CAAC;IAClC;EACF,CAAC,EAAE,CAACtB,UAAU,EAAEF,SAAS,EAAEM,UAAU,CAAC,CAAC;;EAEvC;EACAzB,SAAS,CAAC,MAAM;IACd,MAAM4C,mBAAmB,GAAIC,CAAC,IAAK;MACjC,IAAIX,gBAAgB,EAAE;QACpB;QACA,IAAIW,CAAC,CAACC,OAAO,KAAKD,CAAC,CAACE,GAAG,KAAK,GAAG,IAAIF,CAAC,CAACE,GAAG,KAAK,GAAG,CAAC,EAAE;UACjDF,CAAC,CAACG,cAAc,CAAC,CAAC;UAClBH,CAAC,CAACI,eAAe,CAAC,CAAC;QACrB;QACA,IAAIJ,CAAC,CAACE,GAAG,KAAK,KAAK,IAAKF,CAAC,CAACC,OAAO,IAAID,CAAC,CAACK,QAAQ,IAAIL,CAAC,CAACE,GAAG,KAAK,GAAI,EAAE;UACjEF,CAAC,CAACG,cAAc,CAAC,CAAC;UAClBH,CAAC,CAACI,eAAe,CAAC,CAAC;QACrB;MACF;IACF,CAAC;IAED,IAAIf,gBAAgB,EAAE;MACpBiB,QAAQ,CAACC,gBAAgB,CAAC,SAAS,EAAER,mBAAmB,EAAE,IAAI,CAAC;MAC/D;MACAO,QAAQ,CAACC,gBAAgB,CAAC,aAAa,EAAGP,CAAC,IAAKA,CAAC,CAACG,cAAc,CAAC,CAAC,CAAC;IACrE;IAEA,OAAO,MAAM;MACXG,QAAQ,CAACE,mBAAmB,CAAC,SAAS,EAAET,mBAAmB,EAAE,IAAI,CAAC;MAClEO,QAAQ,CAACE,mBAAmB,CAAC,aAAa,EAAGR,CAAC,IAAKA,CAAC,CAACG,cAAc,CAAC,CAAC,CAAC;IACxE,CAAC;EACH,CAAC,EAAE,CAACd,gBAAgB,CAAC,CAAC;EAEtB,MAAMO,QAAQ,GAAG,MAAAA,CAAA,KAAY;IAC3B,IAAI;MACF,MAAM,CAACa,YAAY,EAAEC,kBAAkB,CAAC,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAC,CAC3DxD,WAAW,CAACyD,MAAM,CAAC,CAAC,EACpBxD,WAAW,CAACyD,OAAO,CAAC,CAAC,CACtB,CAAC;MAEFvC,YAAY,CAACkC,YAAY,CAAC;MAC1BhC,aAAa,CAACiC,kBAAkB,CAAC;;MAEjC;MACA,IAAI,CAAAf,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEoB,IAAI,MAAK,SAAS,EAAE;QAC5BC,iBAAiB,CAAC,CAAC;MACrB;IACF,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IAClD,CAAC,SAAS;MACRtC,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,MAAMqC,iBAAiB,GAAG,MAAAA,CAAA,KAAY;IACpC,IAAI;MACF,MAAMG,SAAS,GAAG,MAAM/D,WAAW,CAACgE,YAAY,CAAC,CAAC;MAClD,MAAMC,WAAW,GAAG,IAAIrC,GAAG,CAACmC,SAAS,CAACG,GAAG,CAACC,GAAG,IAAIA,GAAG,CAACC,GAAG,CAAC,CAAC;MAC1D9B,gBAAgB,CAAC2B,WAAW,CAAC;IAC/B,CAAC,CAAC,OAAOJ,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;IACvD;EACF,CAAC;EAED,MAAMQ,aAAa,GAAG,MAAAA,CAAA,KAAY;IAChC,IAAI;MACF,MAAMN,SAAS,GAAG,MAAM/D,WAAW,CAACgE,YAAY,CAAC,CAAC;MAClDM,oBAAoB,CAACP,SAAS,CAAC;IACjC,CAAC,CAAC,OAAOF,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IAClD;EACF,CAAC;EAED,MAAMnB,8BAA8B,GAAGA,CAAA,KAAM;IAC3C;IACA,MAAM6B,eAAe,GAAGC,SAAS,KAAK,WAAW,GAAGC,iBAAiB,GAAGvD,SAAS;;IAEjF;IACA,IAAIsD,SAAS,KAAK,WAAW,EAAE;MAC7B,IAAI,CAAChD,UAAU,EAAE;QACf;QACAQ,uBAAuB,CAAC;UAAE,WAAW,EAAEuC;QAAgB,CAAC,CAAC;QACzDzC,eAAe,CAAC,EAAE,CAAC;QACnB;MACF,CAAC,MAAM;QACL;QACA,MAAM4C,iBAAiB,GAAGH,eAAe,CAACI,MAAM,CAACR,GAAG,IAClDA,GAAG,CAACS,KAAK,CAACC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACtD,UAAU,CAACqD,WAAW,CAAC,CAAC,CAC3D,CAAC;QACD7C,uBAAuB,CAAC;UAAE,WAAW,EAAE0C;QAAkB,CAAC,CAAC;QAC3D5C,eAAe,CAAC,EAAE,CAAC;QACnB;MACF;IACF;IAEA,IAAI,CAACN,UAAU,EAAE;MACf;MACA,MAAMuD,cAAc,GAAG,CAAC,CAAC;MACzB,MAAMC,iBAAiB,GAAG,EAAE;MAE5BT,eAAe,CAACU,OAAO,CAACd,GAAG,IAAI;QAC7B,IAAIA,GAAG,CAACe,QAAQ,IAAIf,GAAG,CAACe,QAAQ,CAACd,GAAG,EAAE;UACpC,IAAI,CAACW,cAAc,CAACZ,GAAG,CAACe,QAAQ,CAACd,GAAG,CAAC,EAAE;YACrCW,cAAc,CAACZ,GAAG,CAACe,QAAQ,CAACd,GAAG,CAAC,GAAG,EAAE;UACvC;UACAW,cAAc,CAACZ,GAAG,CAACe,QAAQ,CAACd,GAAG,CAAC,CAACe,IAAI,CAAChB,GAAG,CAAC;QAC5C,CAAC,MAAM;UACLa,iBAAiB,CAACG,IAAI,CAAChB,GAAG,CAAC;QAC7B;MACF,CAAC,CAAC;MAEF,IAAIa,iBAAiB,CAACvC,MAAM,GAAG,CAAC,EAAE;QAChCsC,cAAc,CAAC,eAAe,CAAC,GAAGC,iBAAiB;MACrD;MAEAhD,uBAAuB,CAAC+C,cAAc,CAAC;MACvCjD,eAAe,CAACV,UAAU,CAAC;MAC3B;IACF;;IAEA;IACA,MAAMgE,WAAW,GAAG5D,UAAU,CAACqD,WAAW,CAAC,CAAC;;IAE5C;IACA,MAAMQ,YAAY,GAAGd,eAAe,CAACI,MAAM,CAACR,GAAG,IAC7CA,GAAG,CAACS,KAAK,CAACC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACM,WAAW,CAC9C,CAAC;;IAED;IACA,MAAME,mBAAmB,GAAG,IAAI1D,GAAG,CAAC,CAAC;IACrC,MAAM2D,aAAa,GAAIC,GAAG,IAAK;MAC7B,IAAIA,GAAG,CAACC,IAAI,CAACZ,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACM,WAAW,CAAC,EAAE;QAChDE,mBAAmB,CAACI,GAAG,CAACF,GAAG,CAACpB,GAAG,CAAC;QAChC;QACA,IAAIoB,GAAG,CAACG,cAAc,EAAE;UACtBL,mBAAmB,CAACI,GAAG,CAACF,GAAG,CAACG,cAAc,CAAC;QAC7C;MACF;MACA,IAAIH,GAAG,CAACI,aAAa,EAAE;QACrBJ,GAAG,CAACI,aAAa,CAACX,OAAO,CAACM,aAAa,CAAC;MAC1C;IACF,CAAC;IACDnE,UAAU,CAAC6D,OAAO,CAACM,aAAa,CAAC;;IAEjC;IACA,MAAMM,0BAA0B,GAAGtB,eAAe,CAACI,MAAM,CAACR,GAAG,IAC3DA,GAAG,CAACe,QAAQ,IAAII,mBAAmB,CAACQ,GAAG,CAAC3B,GAAG,CAACe,QAAQ,CAACd,GAAG,CAC1D,CAAC;;IAED;IACA,MAAM2B,eAAe,GAAG,CAAC,GAAG,IAAInE,GAAG,CAAC,CAAC,GAAGyD,YAAY,EAAE,GAAGQ,0BAA0B,CAAC,CAAC,CAAC;;IAEtF;IACA,MAAMd,cAAc,GAAG,CAAC,CAAC;IACzB,MAAMC,iBAAiB,GAAG,EAAE;IAE5Be,eAAe,CAACd,OAAO,CAACd,GAAG,IAAI;MAC7B,IAAIA,GAAG,CAACe,QAAQ,IAAIf,GAAG,CAACe,QAAQ,CAACd,GAAG,EAAE;QACpC,IAAI,CAACW,cAAc,CAACZ,GAAG,CAACe,QAAQ,CAACd,GAAG,CAAC,EAAE;UACrCW,cAAc,CAACZ,GAAG,CAACe,QAAQ,CAACd,GAAG,CAAC,GAAG,EAAE;QACvC;QACAW,cAAc,CAACZ,GAAG,CAACe,QAAQ,CAACd,GAAG,CAAC,CAACe,IAAI,CAAChB,GAAG,CAAC;MAC5C,CAAC,MAAM;QACLa,iBAAiB,CAACG,IAAI,CAAChB,GAAG,CAAC;MAC7B;IACF,CAAC,CAAC;;IAEF;IACA,MAAM6B,qBAAqB,GAAGzB,eAAe,CAACI,MAAM,CAACR,GAAG,IACtD,CAACA,GAAG,CAACe,QAAQ,IAAIf,GAAG,CAACS,KAAK,CAACC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACM,WAAW,CAC/D,CAAC;IACD,IAAIY,qBAAqB,CAACvD,MAAM,GAAG,CAAC,EAAE;MACpCsC,cAAc,CAAC,eAAe,CAAC,GAAGiB,qBAAqB;IACzD;;IAEA;IACA,MAAMC,kBAAkB,GAAIC,IAAI,IAAK;MACnC,OAAOA,IAAI,CAACvB,MAAM,CAACa,GAAG,IAAI;QACxB,MAAMW,eAAe,GAAGpB,cAAc,CAACS,GAAG,CAACpB,GAAG,CAAC,IAAIW,cAAc,CAACS,GAAG,CAACpB,GAAG,CAAC,CAAC3B,MAAM,GAAG,CAAC;QACrF,MAAM2D,aAAa,GAAGZ,GAAG,CAACC,IAAI,CAACZ,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACM,WAAW,CAAC;QAClE,MAAMiB,wBAAwB,GAAGb,GAAG,CAACI,aAAa,IAAIK,kBAAkB,CAACT,GAAG,CAACI,aAAa,CAAC,CAACnD,MAAM,GAAG,CAAC;QAEtG,IAAI0D,eAAe,IAAIC,aAAa,IAAIC,wBAAwB,EAAE;UAChE;UACA,IAAIb,GAAG,CAACI,aAAa,EAAE;YACrBJ,GAAG,CAACI,aAAa,GAAGK,kBAAkB,CAACT,GAAG,CAACI,aAAa,CAAC;UAC3D;UACA,OAAO,IAAI;QACb;QACA,OAAO,KAAK;MACd,CAAC,CAAC;IACJ,CAAC;IAED,MAAMU,oBAAoB,GAAGL,kBAAkB,CAAC,CAAC,GAAG7E,UAAU,CAAC,CAAC;IAEhEY,uBAAuB,CAAC+C,cAAc,CAAC;IACvCjD,eAAe,CAACwE,oBAAoB,CAAC;EACvC,CAAC;EAED,MAAMC,cAAc,GAAIC,UAAU,IAAK;IACrC,MAAMC,WAAW,GAAG,IAAI7E,GAAG,CAACF,kBAAkB,CAAC;IAC/C,IAAI+E,WAAW,CAACX,GAAG,CAACU,UAAU,CAAC,EAAE;MAC/BC,WAAW,CAACC,MAAM,CAACF,UAAU,CAAC;IAChC,CAAC,MAAM;MACLC,WAAW,CAACf,GAAG,CAACc,UAAU,CAAC;IAC7B;IACA7E,qBAAqB,CAAC8E,WAAW,CAAC;EACpC,CAAC;EAED,MAAME,kBAAkB,GAAG,MAAOzD,QAAQ,IAAK;IAC7Cd,gBAAgB,CAAC,IAAI,CAAC;IACtBF,mBAAmB,CAACgB,QAAQ,CAAC;IAC7Bd,gBAAgB,CAAC,KAAK,CAAC;EACzB,CAAC;EAED,MAAMwE,cAAc,GAAG,MAAAA,CAAOC,UAAU,EAAEC,KAAK,KAAK;IAClDA,KAAK,CAAC9D,eAAe,CAAC,CAAC,CAAC,CAAC;;IAEzB,IAAI;MACF,IAAIX,aAAa,CAACyD,GAAG,CAACe,UAAU,CAAC,EAAE;QACjC,MAAM7G,WAAW,CAAC+G,mBAAmB,CAACF,UAAU,CAAC;QACjDvE,gBAAgB,CAAC0E,IAAI,IAAI;UACvB,MAAMC,MAAM,GAAG,IAAIrF,GAAG,CAACoF,IAAI,CAAC;UAC5BC,MAAM,CAACP,MAAM,CAACG,UAAU,CAAC;UACzB,OAAOI,MAAM;QACf,CAAC,CAAC;;QAEF;QACA,IAAIzC,SAAS,KAAK,WAAW,EAAE;UAC7BH,aAAa,CAAC,CAAC;QACjB;MACF,CAAC,MAAM;QACL,MAAMrE,WAAW,CAACkH,cAAc,CAACL,UAAU,CAAC;QAC5CvE,gBAAgB,CAAC0E,IAAI,IAAI,IAAIpF,GAAG,CAAC,CAAC,GAAGoF,IAAI,EAAEH,UAAU,CAAC,CAAC,CAAC;MAC1D;IACF,CAAC,CAAC,OAAOhD,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IAClD;EACF,CAAC;EAED,MAAMsD,WAAW,GAAGA,CAAA,KAAM;IACxBjF,mBAAmB,CAAC,IAAI,CAAC;EAC3B,CAAC;EAED,MAAMkF,cAAc,GAAIC,QAAQ,IAAK;IACnC,OAAOrH,WAAW,CAACsH,QAAQ,CAACD,QAAQ,CAAC;EACvC,CAAC;EAED,MAAME,gBAAgB,GAAIF,QAAQ,IAAK;IACrC;IACA,MAAMG,QAAQ,GAAGH,QAAQ,CAACI,KAAK,CAAC,OAAO,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAAC;IAChD,OAAOF,QAAQ,CAACC,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC7C,WAAW,CAAC,CAAC;EAChD,CAAC;EAED,MAAM8C,oBAAoB,GAAGA,CAAA,KAAM;IACjC,IAAI,CAAC1F,gBAAgB,EAAE,OAAO,IAAI;IAElC,MAAM2F,aAAa,GAAGL,gBAAgB,CAACtF,gBAAgB,CAACoF,QAAQ,CAAC;IACjE,MAAMQ,WAAW,GAAGT,cAAc,CAACnF,gBAAgB,CAACoF,QAAQ,CAAC;;IAE7D;IACA,MAAMS,aAAa,GAAIlF,CAAC,IAAK;MAC3B,IAAIA,CAAC,CAACC,OAAO,KAAKD,CAAC,CAACE,GAAG,KAAK,GAAG,IAAIF,CAAC,CAACE,GAAG,KAAK,GAAG,CAAC,EAAE;QACjDF,CAAC,CAACG,cAAc,CAAC,CAAC;QAClBH,CAAC,CAACI,eAAe,CAAC,CAAC;MACrB;MACA,IAAIJ,CAAC,CAACE,GAAG,KAAK,KAAK,IAAKF,CAAC,CAACC,OAAO,IAAID,CAAC,CAACK,QAAQ,IAAIL,CAAC,CAACE,GAAG,KAAK,GAAI,EAAE;QACjEF,CAAC,CAACG,cAAc,CAAC,CAAC;QAClBH,CAAC,CAACI,eAAe,CAAC,CAAC;MACrB;IACF,CAAC;IAED,oBACEnC,OAAA;MACEkH,SAAS,EAAC,gFAAgF;MAC1FC,SAAS,EAAEF,aAAc;MACzBG,QAAQ,EAAE,CAAC,CAAE;MACbC,KAAK,EAAE;QAAEC,OAAO,EAAE;MAAO,CAAE;MAAAC,QAAA,eAE3BvH,OAAA;QACEkH,SAAS,EAAC,gFAAgF;QAC1FG,KAAK,EAAE;UACLG,gBAAgB,EAAE,MAAM;UACxBC,aAAa,EAAE,MAAM;UACrBC,YAAY,EAAE,MAAM;UACpBC,UAAU,EAAE;QACd,CAAE;QAAAJ,QAAA,gBAGFvH,OAAA;UAAKkH,SAAS,EAAC,gDAAgD;UAAAK,QAAA,gBAC7DvH,OAAA;YAAKkH,SAAS,EAAC,6BAA6B;YAAAK,QAAA,gBAC1CvH,OAAA,CAACX,QAAQ;cAAC6H,SAAS,EAAC;YAAuB;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eAC9C/H,OAAA;cAAAuH,QAAA,gBACEvH,OAAA;gBAAIkH,SAAS,EAAC,mCAAmC;gBAAAK,QAAA,EAC9CnG,gBAAgB,CAAC2C;cAAK;gBAAA6D,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACrB,CAAC,eACL/H,OAAA;gBAAGkH,SAAS,EAAC,uBAAuB;gBAAAK,QAAA,GAAC,cACvB,EAAC,IAAIS,IAAI,CAAC5G,gBAAgB,CAAC6G,SAAS,CAAC,CAACC,kBAAkB,CAAC,CAAC;cAAA;gBAAAN,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACrE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACD,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eACN/H,OAAA;YACEmI,OAAO,EAAE7B,WAAY;YACrBY,SAAS,EAAC,oCAAoC;YAAAK,QAAA,eAE9CvH,OAAA,CAACJ,CAAC;cAACsH,SAAS,EAAC;YAAuB;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACjC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC,eAGN/H,OAAA;UAAKkH,SAAS,EAAC,wBAAwB;UAAAK,QAAA,EACpCjG,aAAa,gBACZtB,OAAA;YAAKkH,SAAS,EAAC,yCAAyC;YAAAK,QAAA,eACtDvH,OAAA;cAAKkH,SAAS,EAAC;YAAgE;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnF,CAAC,gBAES/H,OAAA;YAAKkH,SAAS,EAAC,eAAe;YAAAK,QAAA,EACzC,CAAC,KAAK,CAAC,CAACtD,QAAQ,CAAC8C,aAAa,CAAC,gBAC9B/G,OAAA;cACEoI,GAAG,EAAE,GAAGpB,WAAW,6CAA8C;cACjEE,SAAS,EAAC,wBAAwB;cAClCnD,KAAK,EAAE3C,gBAAgB,CAAC2C,KAAM;cAC9BsD,KAAK,EAAE;gBACLM,UAAU,EAAE,MAAM;gBAClBH,gBAAgB,EAAE,MAAM;gBACxBC,aAAa,EAAE,MAAM;gBACrBC,YAAY,EAAE;cAChB,CAAE;cACFW,MAAM,EAAGtG,CAAC,IAAK;gBAAA,IAAAuG,qBAAA,EAAAC,sBAAA;gBACb;gBACA,CAAAD,qBAAA,GAAAvG,CAAC,CAACyG,MAAM,CAACC,eAAe,cAAAH,qBAAA,uBAAxBA,qBAAA,CAA0BhG,gBAAgB,CAAC,aAAa,EAAG2D,KAAK,IAAK;kBACnEA,KAAK,CAAC/D,cAAc,CAAC,CAAC;gBACxB,CAAC,CAAC;gBACF;gBACA,CAAAqG,sBAAA,GAAAxG,CAAC,CAACyG,MAAM,CAACC,eAAe,cAAAF,sBAAA,uBAAxBA,sBAAA,CAA0BjG,gBAAgB,CAAC,SAAS,EAAG2D,KAAK,IAAK;kBAC/D,IAAIA,KAAK,CAACjE,OAAO,KAAKiE,KAAK,CAAChE,GAAG,KAAK,GAAG,IAAIgE,KAAK,CAAChE,GAAG,KAAK,GAAG,CAAC,EAAE;oBAC7DgE,KAAK,CAAC/D,cAAc,CAAC,CAAC;kBACxB;gBACF,CAAC,CAAC;cACJ;YAAE;cAAA0F,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,GACA,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC9D,QAAQ,CAAC8C,aAAa,CAAC,gBACtE/G,OAAA;cAAKkH,SAAS,EAAC,kEAAkE;cAAAK,QAAA,eAC/EvH,OAAA;gBACEoI,GAAG,EAAEpB,WAAY;gBACjB0B,GAAG,EAAEtH,gBAAgB,CAAC2C,KAAM;gBAC5BmD,SAAS,EAAC,sCAAsC;gBAChDG,KAAK,EAAE;kBACLM,UAAU,EAAE,MAAM;kBAClBH,gBAAgB,EAAE,MAAM;kBACxBC,aAAa,EAAE,MAAM;kBACrBC,YAAY,EAAE;gBAChB,CAAE;gBACFiB,aAAa,EAAG5G,CAAC,IAAKA,CAAC,CAACG,cAAc,CAAC,CAAE;gBACzC0G,SAAS,EAAE;cAAM;gBAAAhB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAClB;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC,GACJ,CAAC,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC9D,QAAQ,CAAC8C,aAAa,CAAC,gBAC9C/G,OAAA;cACEoI,GAAG,EAAEpB,WAAY;cACjBE,SAAS,EAAC,wBAAwB;cAClCnD,KAAK,EAAE3C,gBAAgB,CAAC2C,KAAM;cAC9BsD,KAAK,EAAE;gBACLM,UAAU,EAAE,MAAM;gBAClBH,gBAAgB,EAAE,MAAM;gBACxBC,aAAa,EAAE,MAAM;gBACrBC,YAAY,EAAE;cAChB,CAAE;cACFW,MAAM,EAAGtG,CAAC,IAAK;gBAAA,IAAA8G,sBAAA,EAAAC,sBAAA;gBACb;gBACA,CAAAD,sBAAA,GAAA9G,CAAC,CAACyG,MAAM,CAACC,eAAe,cAAAI,sBAAA,uBAAxBA,sBAAA,CAA0BvG,gBAAgB,CAAC,aAAa,EAAG2D,KAAK,IAAK;kBACnEA,KAAK,CAAC/D,cAAc,CAAC,CAAC;gBACxB,CAAC,CAAC;gBACF;gBACA,CAAA4G,sBAAA,GAAA/G,CAAC,CAACyG,MAAM,CAACC,eAAe,cAAAK,sBAAA,uBAAxBA,sBAAA,CAA0BxG,gBAAgB,CAAC,SAAS,EAAG2D,KAAK,IAAK;kBAC/D,IAAIA,KAAK,CAACjE,OAAO,KAAKiE,KAAK,CAAChE,GAAG,KAAK,GAAG,IAAIgE,KAAK,CAAChE,GAAG,KAAK,GAAG,CAAC,EAAE;oBAC7DgE,KAAK,CAAC/D,cAAc,CAAC,CAAC;kBACxB;gBACF,CAAC,CAAC;cACJ;YAAE;cAAA0F,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,GACA,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC9D,QAAQ,CAAC8C,aAAa,CAAC,gBACvE/G,OAAA;cACEoI,GAAG,EAAE,sCAAsCW,kBAAkB,CAAC/B,WAAW,CAAC,mCAAoC;cAC9GE,SAAS,EAAC,wBAAwB;cAClCnD,KAAK,EAAE3C,gBAAgB,CAAC2C,KAAM;cAC9BsD,KAAK,EAAE;gBACLM,UAAU,EAAE,MAAM;gBAClBH,gBAAgB,EAAE,MAAM;gBACxBC,aAAa,EAAE,MAAM;gBACrBC,YAAY,EAAE;cAChB,CAAE;cACFW,MAAM,EAAGtG,CAAC,IAAK;gBAAA,IAAAiH,sBAAA;gBACb;gBACA,CAAAA,sBAAA,GAAAjH,CAAC,CAACyG,MAAM,CAACC,eAAe,cAAAO,sBAAA,uBAAxBA,sBAAA,CAA0B1G,gBAAgB,CAAC,aAAa,EAAG2D,KAAK,IAAK;kBACnEA,KAAK,CAAC/D,cAAc,CAAC,CAAC;gBACxB,CAAC,CAAC;cACJ;YAAE;cAAA0F,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,gBAEF/H,OAAA;cAAKkH,SAAS,EAAC,oDAAoD;cAAAK,QAAA,eACjEvH,OAAA;gBAAKkH,SAAS,EAAC,aAAa;gBAAAK,QAAA,gBAC1BvH,OAAA,CAACX,QAAQ;kBAAC6H,SAAS,EAAC;gBAAsC;kBAAAU,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,eAC7D/H,OAAA;kBAAIkH,SAAS,EAAC,wCAAwC;kBAAAK,QAAA,EAAC;gBAEvD;kBAAAK,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACL/H,OAAA;kBAAGkH,SAAS,EAAC,eAAe;kBAAAK,QAAA,GAAC,kBACX,EAACR,aAAa,EAAC,iCACjC;gBAAA;kBAAAa,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAG,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACD;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH;UACN;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE;QACP;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV,CAAC;EAED,MAAMkB,aAAa,GAAGA,CAACC,IAAI,EAAEvI,UAAU,KAAK;IAC1C,IAAI,CAACA,UAAU,EAAE,OAAOuI,IAAI;IAE5B,MAAMC,KAAK,GAAGD,IAAI,CAACtC,KAAK,CAAC,IAAIwC,MAAM,CAAC,IAAIzI,UAAU,GAAG,EAAE,IAAI,CAAC,CAAC;IAC7D,OAAOwI,KAAK,CAAC9F,GAAG,CAAC,CAACgG,IAAI,EAAEC,KAAK,KAC3BD,IAAI,CAACrF,WAAW,CAAC,CAAC,KAAKrD,UAAU,CAACqD,WAAW,CAAC,CAAC,gBAC7ChE,OAAA;MAAkBkH,SAAS,EAAC,6BAA6B;MAAAK,QAAA,EAAE8B;IAAI,GAApDC,KAAK;MAAA1B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAsD,CAAC,GACvEsB,IACJ,CAAC;EACH,CAAC;EAED,MAAME,cAAc,GAAGA,CAAClF,QAAQ,EAAEmF,KAAK,GAAG,CAAC,KAAK;IAC9C,MAAMC,UAAU,GAAG5I,kBAAkB,CAACoE,GAAG,CAACZ,QAAQ,CAACd,GAAG,CAAC;IACvD,MAAMmG,YAAY,GAAGxI,oBAAoB,CAACmD,QAAQ,CAACd,GAAG,CAAC,IAAIrC,oBAAoB,CAACmD,QAAQ,CAACd,GAAG,CAAC,CAAC3B,MAAM,GAAG,CAAC;IACxG,MAAM+H,gBAAgB,GAAGtF,QAAQ,CAACU,aAAa,IAAIV,QAAQ,CAACU,aAAa,CAACnD,MAAM,GAAG,CAAC;IACpF,MAAMgI,UAAU,GAAGF,YAAY,IAAIC,gBAAgB;IACnD,MAAMpE,aAAa,GAAG5E,UAAU,IAAI0D,QAAQ,CAACO,IAAI,CAACZ,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACtD,UAAU,CAACqD,WAAW,CAAC,CAAC,CAAC;IAElG,oBACEhE,OAAA;MAAwBkH,SAAS,EAAC,4BAA4B;MAAAK,QAAA,gBAC5DvH,OAAA;QACEkH,SAAS,EAAE,+DACT3B,aAAa,GAAG,cAAc,GAC9BiE,KAAK,KAAK,CAAC,GAAG,aAAa,GAAGA,KAAK,KAAK,CAAC,GAAG,YAAY,GAAG,UAAU,EACpE;QACHnC,KAAK,EAAE;UAAEwC,WAAW,EAAE,GAAG,EAAE,GAAGL,KAAK,GAAG,EAAE;QAAK,CAAE;QAC/CrB,OAAO,EAAEA,CAAA,KAAMyB,UAAU,IAAIlE,cAAc,CAACrB,QAAQ,CAACd,GAAG,CAAE;QAAAgE,QAAA,gBAE1DvH,OAAA;UAAKkH,SAAS,EAAC,oCAAoC;UAAAK,QAAA,GAChDqC,UAAU,GACTH,UAAU,gBACRzJ,OAAA,CAACT,WAAW;YAAC2H,SAAS,EAAC;UAAuB;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,gBAEjD/H,OAAA,CAACR,YAAY;YAAC0H,SAAS,EAAC;UAAuB;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAClD,gBAED/H,OAAA;YAAKkH,SAAS,EAAC;UAAS;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAC3B,EAEA0B,UAAU,gBACTzJ,OAAA,CAACN,UAAU;YAACwH,SAAS,EAAC;UAAuB;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,gBAEhD/H,OAAA,CAACP,MAAM;YAACyH,SAAS,EAAC;UAAuB;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAC5C,eAED/H,OAAA;YAAMkH,SAAS,EAAE,eACfsC,KAAK,KAAK,CAAC,GAAG,eAAe,GAAGA,KAAK,KAAK,CAAC,GAAG,eAAe,GAAG,eAAe,EAC9E;YAAAjC,QAAA,EACA0B,aAAa,CAAC5E,QAAQ,CAACO,IAAI,EAAEjE,UAAU;UAAC;YAAAiH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACrC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACJ,CAAC,EAEL2B,YAAY,iBACX1J,OAAA;UAAMkH,SAAS,EAAC,mGAAmG;UAAAK,QAAA,EAChHrG,oBAAoB,CAACmD,QAAQ,CAACd,GAAG,CAAC,CAAC3B;QAAM;UAAAgG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtC,CACP;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC,EAEL0B,UAAU,IAAIG,UAAU,iBACvB5J,OAAA;QAAKkH,SAAS,EAAC,MAAM;QAAAK,QAAA,GAElBmC,YAAY,iBACX1J,OAAA;UAAKkH,SAAS,EAAC,gBAAgB;UAAAK,QAAA,EAC5BrG,oBAAoB,CAACmD,QAAQ,CAACd,GAAG,CAAC,CAACF,GAAG,CAAEhB,QAAQ,iBAC/CrC,OAAA;YAEEkH,SAAS,EAAC,8EAA8E;YACxFG,KAAK,EAAE;cAAEwC,WAAW,EAAE,GAAG,EAAE,GAAG,CAACL,KAAK,GAAG,CAAC,IAAI,EAAE;YAAK,CAAE;YAAAjC,QAAA,gBAErDvH,OAAA;cAAKkH,SAAS,EAAC,oCAAoC;cAAAK,QAAA,gBACjDvH,OAAA,CAACX,QAAQ;gBAAC6H,SAAS,EAAC;cAAuB;gBAAAU,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,eAC9C/H,OAAA;gBAAAuH,QAAA,gBACEvH,OAAA;kBAAGkH,SAAS,EAAC,4CAA4C;kBAAAK,QAAA,EACtD0B,aAAa,CAAC5G,QAAQ,CAAC0B,KAAK,EAAEpD,UAAU;gBAAC;kBAAAiH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACzC,CAAC,eACJ/H,OAAA;kBAAGkH,SAAS,EAAC,uBAAuB;kBAAAK,QAAA,EACjC,IAAIS,IAAI,CAAC3F,QAAQ,CAAC4F,SAAS,CAAC,CAACC,kBAAkB,CAAC;gBAAC;kBAAAN,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACjD,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACD,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eACN/H,OAAA;cAAKkH,SAAS,EAAC,6BAA6B;cAAAK,QAAA,GACzC,CAAA7F,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEoB,IAAI,MAAK,SAAS,iBACvB9C,OAAA;gBACEmI,OAAO,EAAGpG,CAAC,IAAKgE,cAAc,CAAC1D,QAAQ,CAACkB,GAAG,EAAExB,CAAC,CAAE;gBAChDmF,SAAS,EAAC,oCAAoC;gBAC9CnD,KAAK,EAAEvC,aAAa,CAACyD,GAAG,CAAC5C,QAAQ,CAACkB,GAAG,CAAC,GAAG,uBAAuB,GAAG,kBAAmB;gBAAAgE,QAAA,eAEtFvH,OAAA,CAACH,IAAI;kBACHqH,SAAS,EAAE,WACT1F,aAAa,CAACyD,GAAG,CAAC5C,QAAQ,CAACkB,GAAG,CAAC,GAC3B,iCAAiC,GACjC,qCAAqC;gBACxC;kBAAAqE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACJ;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACI,CACT,eACD/H,OAAA;gBACEmI,OAAO,EAAEA,CAAA,KAAMrC,kBAAkB,CAACzD,QAAQ,CAAE;gBAC5C6E,SAAS,EAAC,8MAA8M;gBAAAK,QAAA,gBAExNvH,OAAA,CAACL,GAAG;kBAACuH,SAAS,EAAC;gBAAc;kBAAAU,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,QAElC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN,CAAC;UAAA,GAtCD1F,QAAQ,CAACkB,GAAG;YAAAqE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAuCd,CACN;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CACN,EAGA4B,gBAAgB,iBACf3J,OAAA;UAAAuH,QAAA,EACGlD,QAAQ,CAACU,aAAa,CAAC1B,GAAG,CAACyG,WAAW,IACrCP,cAAc,CAACO,WAAW,EAAEN,KAAK,GAAG,CAAC,CACvC;QAAC;UAAA5B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CACN;IAAA,GApGO1D,QAAQ,CAACd,GAAG;MAAAqE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAqGjB,CAAC;EAEV,CAAC;EAED,MAAMgC,mBAAmB,GAAGA,CAAA,KAAM;IAChC,MAAMC,YAAY,GAAG9I,oBAAoB,CAAC,WAAW,CAAC;IACtD,IAAI,CAAC8I,YAAY,IAAIA,YAAY,CAACpI,MAAM,KAAK,CAAC,EAAE,OAAO,IAAI;IAE3D,oBACE5B,OAAA;MAAKkH,SAAS,EAAC,WAAW;MAAAK,QAAA,EACvByC,YAAY,CAAC3G,GAAG,CAAEhB,QAAQ,iBACzBrC,OAAA;QAEEkH,SAAS,EAAC,gGAAgG;QAAAK,QAAA,gBAE1GvH,OAAA;UAAKkH,SAAS,EAAC,oCAAoC;UAAAK,QAAA,gBACjDvH,OAAA,CAACX,QAAQ;YAAC6H,SAAS,EAAC;UAAuB;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAC9C/H,OAAA;YAAAuH,QAAA,gBACEvH,OAAA;cAAGkH,SAAS,EAAC,4CAA4C;cAAAK,QAAA,EACtD0B,aAAa,CAAC5G,QAAQ,CAAC0B,KAAK,EAAEpD,UAAU;YAAC;cAAAiH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACzC,CAAC,eACJ/H,OAAA;cAAKkH,SAAS,EAAC,mDAAmD;cAAAK,QAAA,gBAChEvH,OAAA;gBAAAuH,QAAA,EAAO,IAAIS,IAAI,CAAC3F,QAAQ,CAAC4F,SAAS,CAAC,CAACC,kBAAkB,CAAC;cAAC;gBAAAN,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,EAC/D1F,QAAQ,CAACgC,QAAQ,iBAChBrE,OAAA,CAAAE,SAAA;gBAAAqH,QAAA,gBACEvH,OAAA;kBAAAuH,QAAA,EAAM;gBAAC;kBAAAK,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,eACd/H,OAAA;kBAAMkH,SAAS,EAAC,sCAAsC;kBAAAK,QAAA,EACnDlF,QAAQ,CAACgC,QAAQ,CAACO;gBAAI;kBAAAgD,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACnB,CAAC;cAAA,eACP,CACH;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eACN/H,OAAA;UAAKkH,SAAS,EAAC,6BAA6B;UAAAK,QAAA,gBAC1CvH,OAAA;YACEmI,OAAO,EAAGpG,CAAC,IAAKgE,cAAc,CAAC1D,QAAQ,CAACkB,GAAG,EAAExB,CAAC,CAAE;YAChDmF,SAAS,EAAC,oCAAoC;YAC9CnD,KAAK,EAAC,uBAAuB;YAAAwD,QAAA,eAE7BvH,OAAA,CAACH,IAAI;cAACqH,SAAS,EAAC;YAAyC;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACtD,CAAC,eACT/H,OAAA;YACEmI,OAAO,EAAEA,CAAA,KAAMrC,kBAAkB,CAACzD,QAAQ,CAAE;YAC5C6E,SAAS,EAAC,gNAAgN;YAAAK,QAAA,gBAE1NvH,OAAA,CAACL,GAAG;cAACuH,SAAS,EAAC;YAAc;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,QAElC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA,GArCD1F,QAAQ,CAACkB,GAAG;QAAAqE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAsCd,CACN;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC;EAEV,CAAC;EAED,MAAMkC,4BAA4B,GAAGA,CAAA,KAAM;IACzC,MAAM9F,iBAAiB,GAAGjD,oBAAoB,CAAC,eAAe,CAAC;IAC/D,IAAI,CAACiD,iBAAiB,IAAIA,iBAAiB,CAACvC,MAAM,KAAK,CAAC,EAAE,OAAO,IAAI;IAErE,MAAM6H,UAAU,GAAG5I,kBAAkB,CAACoE,GAAG,CAAC,eAAe,CAAC;IAE1D,oBACEjF,OAAA;MAAKkH,SAAS,EAAC,4BAA4B;MAAAK,QAAA,gBACzCvH,OAAA;QACEkH,SAAS,EAAC,yEAAyE;QACnFiB,OAAO,EAAEA,CAAA,KAAMzC,cAAc,CAAC,eAAe,CAAE;QAAA6B,QAAA,gBAE/CvH,OAAA;UAAKkH,SAAS,EAAC,oCAAoC;UAAAK,QAAA,GAChDkC,UAAU,gBACTzJ,OAAA,CAACT,WAAW;YAAC2H,SAAS,EAAC;UAAuB;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,gBAEjD/H,OAAA,CAACR,YAAY;YAAC0H,SAAS,EAAC;UAAuB;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAClD,EAEA0B,UAAU,gBACTzJ,OAAA,CAACN,UAAU;YAACwH,SAAS,EAAC;UAAuB;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,gBAEhD/H,OAAA,CAACP,MAAM;YAACyH,SAAS,EAAC;UAAuB;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAC5C,eAED/H,OAAA;YAAMkH,SAAS,EAAC,2BAA2B;YAAAK,QAAA,EAAC;UAE5C;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACJ,CAAC,eAEN/H,OAAA;UAAMkH,SAAS,EAAC,mGAAmG;UAAAK,QAAA,EAChHpD,iBAAiB,CAACvC;QAAM;UAAAgG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrB,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CAAC,EAEL0B,UAAU,iBACTzJ,OAAA;QAAKkH,SAAS,EAAC,qBAAqB;QAAAK,QAAA,EACjCpD,iBAAiB,CAACd,GAAG,CAAEhB,QAAQ,iBAC9BrC,OAAA;UAEEkH,SAAS,EAAC,8EAA8E;UACxFG,KAAK,EAAE;YAAEwC,WAAW,EAAE;UAAO,CAAE;UAAAtC,QAAA,gBAE/BvH,OAAA;YAAKkH,SAAS,EAAC,oCAAoC;YAAAK,QAAA,gBACjDvH,OAAA,CAACX,QAAQ;cAAC6H,SAAS,EAAC;YAAuB;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eAC9C/H,OAAA;cAAAuH,QAAA,gBACEvH,OAAA;gBAAGkH,SAAS,EAAC,4CAA4C;gBAAAK,QAAA,EACtD0B,aAAa,CAAC5G,QAAQ,CAAC0B,KAAK,EAAEpD,UAAU;cAAC;gBAAAiH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACzC,CAAC,eACJ/H,OAAA;gBAAGkH,SAAS,EAAC,uBAAuB;gBAAAK,QAAA,EACjC,IAAIS,IAAI,CAAC3F,QAAQ,CAAC4F,SAAS,CAAC,CAACC,kBAAkB,CAAC;cAAC;gBAAAN,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACjD,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACD,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eACN/H,OAAA;YAAKkH,SAAS,EAAC,6BAA6B;YAAAK,QAAA,GACzC,CAAA7F,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEoB,IAAI,MAAK,SAAS,iBACvB9C,OAAA;cACEmI,OAAO,EAAGpG,CAAC,IAAKgE,cAAc,CAAC1D,QAAQ,CAACkB,GAAG,EAAExB,CAAC,CAAE;cAChDmF,SAAS,EAAC,oCAAoC;cAC9CnD,KAAK,EAAEvC,aAAa,CAACyD,GAAG,CAAC5C,QAAQ,CAACkB,GAAG,CAAC,GAAG,uBAAuB,GAAG,kBAAmB;cAAAgE,QAAA,eAEtFvH,OAAA,CAACH,IAAI;gBACHqH,SAAS,EAAE,WACT1F,aAAa,CAACyD,GAAG,CAAC5C,QAAQ,CAACkB,GAAG,CAAC,GAC3B,iCAAiC,GACjC,qCAAqC;cACxC;gBAAAqE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACJ;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACI,CACT,eACD/H,OAAA;cACEmI,OAAO,EAAEA,CAAA,KAAMrC,kBAAkB,CAACzD,QAAQ,CAAE;cAC5C6E,SAAS,EAAC,8MAA8M;cAAAK,QAAA,gBAExNvH,OAAA,CAACL,GAAG;gBAACuH,SAAS,EAAC;cAAc;gBAAAU,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC,QAElC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAAA,GAtCD1F,QAAQ,CAACkB,GAAG;UAAAqE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAuCd,CACN;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC;EAEV,CAAC;EAED,IAAItH,OAAO,EAAE;IACX,oBACET,OAAA;MAAKkH,SAAS,EAAC,uCAAuC;MAAAK,QAAA,eACpDvH,OAAA;QAAKkH,SAAS,EAAC;MAAgE;QAAAU,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACnF,CAAC;EAEV;EAEA,MAAMmC,yBAAyB,GAAGA,CAAA,KAAM;IACtC,MAAMxG,eAAe,GAAGC,SAAS,KAAK,WAAW,GAAGC,iBAAiB,GAAGvD,SAAS;IACjF,IAAI,CAACM,UAAU,EAAE,OAAO+C,eAAe,CAAC9B,MAAM;IAE9C,MAAM2C,WAAW,GAAG5D,UAAU,CAACqD,WAAW,CAAC,CAAC;;IAE5C;IACA,MAAMQ,YAAY,GAAGd,eAAe,CAACI,MAAM,CAACR,GAAG,IAC7CA,GAAG,CAACS,KAAK,CAACC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACM,WAAW,CAC9C,CAAC;;IAED;IACA,MAAME,mBAAmB,GAAG,IAAI1D,GAAG,CAAC,CAAC;IACrC,MAAM2D,aAAa,GAAIC,GAAG,IAAK;MAC7B,IAAIA,GAAG,CAACC,IAAI,CAACZ,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACM,WAAW,CAAC,EAAE;QAChDE,mBAAmB,CAACI,GAAG,CAACF,GAAG,CAACpB,GAAG,CAAC;MAClC;MACA,IAAIoB,GAAG,CAACI,aAAa,EAAE;QACrBJ,GAAG,CAACI,aAAa,CAACX,OAAO,CAACM,aAAa,CAAC;MAC1C;IACF,CAAC;IACDnE,UAAU,CAAC6D,OAAO,CAACM,aAAa,CAAC;IAEjC,MAAMM,0BAA0B,GAAGtB,eAAe,CAACI,MAAM,CAACR,GAAG,IAC3DA,GAAG,CAACe,QAAQ,IAAII,mBAAmB,CAACQ,GAAG,CAAC3B,GAAG,CAACe,QAAQ,CAACd,GAAG,CAC1D,CAAC;;IAED;IACA,MAAM2B,eAAe,GAAG,CAAC,GAAG,IAAInE,GAAG,CAAC,CAAC,GAAGyD,YAAY,EAAE,GAAGQ,0BAA0B,CAAC,CAAC,CAAC;IACtF,OAAOE,eAAe,CAACtD,MAAM;EAC/B,CAAC;EAED,MAAMuI,cAAc,GAAGD,yBAAyB,CAAC,CAAC;EAElD,oBACElK,OAAA;IAAKkH,SAAS,EAAC,WAAW;IAAAK,QAAA,gBAExBvH,OAAA;MAAKkH,SAAS,EAAC,4BAA4B;MAAAK,QAAA,eACzCvH,OAAA;QAAKkH,SAAS,EAAC,kBAAkB;QAAAK,QAAA,gBAC/BvH,OAAA;UAAIkH,SAAS,EAAC,6CAA6C;UAAAK,QAAA,EAAC;QAE5D;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACL/H,OAAA;UAAGkH,SAAS,EAAC,4BAA4B;UAAAK,QAAA,EAAC;QAE1C;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,EAGL,CAAArG,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEoB,IAAI,MAAK,SAAS,iBACvB9C,OAAA;MAAKkH,SAAS,EAAC,4BAA4B;MAAAK,QAAA,eACzCvH,OAAA;QAAKkH,SAAS,EAAC,mBAAmB;QAAAK,QAAA,eAChCvH,OAAA;UAAKkH,SAAS,EAAC,gBAAgB;UAAAK,QAAA,gBAC7BvH,OAAA;YACEmI,OAAO,EAAEA,CAAA,KAAMiC,YAAY,CAAC,KAAK,CAAE;YACnClD,SAAS,EAAE,4CACTvD,SAAS,KAAK,KAAK,GACf,2BAA2B,GAC3B,mCAAmC,EACtC;YAAA4D,QAAA,EACJ;UAED;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACT/H,OAAA;YACEmI,OAAO,EAAEA,CAAA,KAAMiC,YAAY,CAAC,WAAW,CAAE;YACzClD,SAAS,EAAE,wEACTvD,SAAS,KAAK,WAAW,GACrB,2BAA2B,GAC3B,mCAAmC,EACtC;YAAA4D,QAAA,gBAEHvH,OAAA,CAACH,IAAI;cAACqH,SAAS,EAAC;YAAS;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC,eAC5B/H,OAAA;cAAAuH,QAAA,EAAM;YAAS;cAAAK,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,EACrBvG,aAAa,CAAC6I,IAAI,GAAG,CAAC,iBACrBrK,OAAA;cAAMkH,SAAS,EAAC,qGAAqG;cAAAK,QAAA,EAClH/F,aAAa,CAAC6I;YAAI;cAAAzC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACf,CACP;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACK,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,eAGD/H,OAAA;MAAKkH,SAAS,EAAC,4BAA4B;MAAAK,QAAA,eACzCvH,OAAA;QAAKkH,SAAS,EAAC,kBAAkB;QAAAK,QAAA,eACnBvH,OAAA;UAAAuH,QAAA,gBACRvH,OAAA;YAAOsK,OAAO,EAAC,QAAQ;YAACpD,SAAS,EAAC,yCAAyC;YAAAK,QAAA,EAAC;UAE5E;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACR/H,OAAA;YAAKkH,SAAS,EAAC,oCAAoC;YAAAK,QAAA,gBACjDvH,OAAA;cAAKkH,SAAS,EAAC,sEAAsE;cAAAK,QAAA,eACnFvH,OAAA,CAACV,MAAM;gBAAC4H,SAAS,EAAC;cAAuB;gBAAAU,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACzC,CAAC,eACN/H,OAAA;cACEuK,IAAI,EAAC,MAAM;cACXC,EAAE,EAAC,QAAQ;cACXC,KAAK,EAAE9J,UAAW;cAClB+J,QAAQ,EAAG3I,CAAC,IAAKnB,aAAa,CAACmB,CAAC,CAACyG,MAAM,CAACiC,KAAK,CAAE;cAC/CvD,SAAS,EAAC,oGAAoG;cAC9GyD,WAAW,EAAC;YAA8C;cAAA/C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC3D,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC,eACN/H,OAAA;YAAGkH,SAAS,EAAC,4BAA4B;YAAAK,QAAA,EAAC;UAE1C;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACL;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAGN/H,OAAA;MAAKkH,SAAS,EAAC,4BAA4B;MAAAK,QAAA,eACzCvH,OAAA;QAAKkH,SAAS,EAAC,qDAAqD;QAAAK,QAAA,gBAClEvH,OAAA;UAAGkH,SAAS,EAAC,uBAAuB;UAAAK,QAAA,EACjC5G,UAAU,GACT,SAASwJ,cAAc,IAAIxG,SAAS,KAAK,WAAW,GAAG,WAAW,GAAG,EAAE,uBAAuBhD,UAAU,GAAG,GAC3G,GAAGwJ,cAAc,IAAIxG,SAAS,KAAK,WAAW,GAAG,WAAW,GAAG,EAAE;QAAqB;UAAAiE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAEvF,CAAC,eACJ/H,OAAA;UAAKkH,SAAS,EAAC,6BAA6B;UAAAK,QAAA,gBAC1CvH,OAAA;YACEmI,OAAO,EAAEA,CAAA,KAAMrH,qBAAqB,CAAC,IAAIC,GAAG,CAAC,CAAC,CAAE;YAChDmG,SAAS,EAAC,2CAA2C;YAAAK,QAAA,EACtD;UAED;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACT/H,OAAA;YACEmI,OAAO,EAAEA,CAAA,KAAM;cACb,MAAMyC,MAAM,GAAG,IAAI7J,GAAG,CAAC,CAAC;cACxB,MAAM8J,MAAM,GAAIxF,IAAI,IAAK;gBACvBA,IAAI,CAACjB,OAAO,CAACO,GAAG,IAAI;kBAAA,IAAAmG,kBAAA;kBAClB,IAAI5J,oBAAoB,CAACyD,GAAG,CAACpB,GAAG,CAAC,IAAI,EAAAuH,kBAAA,GAAAnG,GAAG,CAACI,aAAa,cAAA+F,kBAAA,uBAAjBA,kBAAA,CAAmBlJ,MAAM,IAAG,CAAC,EAAE;oBAClEgJ,MAAM,CAAC/F,GAAG,CAACF,GAAG,CAACpB,GAAG,CAAC;kBACrB;kBACA,IAAIoB,GAAG,CAACI,aAAa,EAAE;oBACrB8F,MAAM,CAAClG,GAAG,CAACI,aAAa,CAAC;kBAC3B;gBACF,CAAC,CAAC;cACJ,CAAC;cACD8F,MAAM,CAAC7J,YAAY,CAAC;cACpB,IAAIE,oBAAoB,CAAC,eAAe,CAAC,EAAE;gBACzC0J,MAAM,CAAC/F,GAAG,CAAC,eAAe,CAAC;cAC7B;cACA/D,qBAAqB,CAAC8J,MAAM,CAAC;YAC/B,CAAE;YACF1D,SAAS,EAAC,2CAA2C;YAAAK,QAAA,EACtD;UAED;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAGN/H,OAAA;MAAKkH,SAAS,EAAC,+CAA+C;MAAAK,QAAA,EAC3D5D,SAAS,KAAK,WAAW;MACxB;MACAzC,oBAAoB,CAAC,WAAW,CAAC,IAAIA,oBAAoB,CAAC,WAAW,CAAC,CAACU,MAAM,GAAG,CAAC,gBAC/E5B,OAAA;QAAKkH,SAAS,EAAC,KAAK;QAAAK,QAAA,EACjBwC,mBAAmB,CAAC;MAAC;QAAAnC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnB,CAAC,gBAEN/H,OAAA;QAAKkH,SAAS,EAAC,mBAAmB;QAAAK,QAAA,gBAChCvH,OAAA,CAACH,IAAI;UAACqH,SAAS,EAAC;QAAiC;UAAAU,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACpD/H,OAAA;UAAIkH,SAAS,EAAC,wCAAwC;UAAAK,QAAA,EAAC;QAAqB;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACjF/H,OAAA;UAAGkH,SAAS,EAAC,4BAA4B;UAAAK,QAAA,EACtC5G,UAAU,GACP,mDAAmD,GACnD;QAAqE;UAAAiH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CACN;MAED;MACA/G,YAAY,CAACY,MAAM,GAAG,CAAC,IAAIV,oBAAoB,CAAC,eAAe,CAAC,gBAC9DlB,OAAA;QAAKkH,SAAS,EAAC,0BAA0B;QAAAK,QAAA,GACtCvG,YAAY,CAACqC,GAAG,CAACgB,QAAQ,IAAIkF,cAAc,CAAClF,QAAQ,CAAC,CAAC,EACtD4F,4BAA4B,CAAC,CAAC;MAAA;QAAArC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5B,CAAC,gBAEN/H,OAAA;QAAKkH,SAAS,EAAC,mBAAmB;QAAAK,QAAA,gBAChCvH,OAAA,CAACX,QAAQ;UAAC6H,SAAS,EAAC;QAAiC;UAAAU,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACxD/H,OAAA;UAAIkH,SAAS,EAAC,wCAAwC;UAAAK,QAAA,EAAC;QAAkB;UAAAK,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC9E/H,OAAA;UAAGkH,SAAS,EAAC,4BAA4B;UAAAK,QAAA,EACtC5G,UAAU,GACP,qCAAqC,GACrC;QAAsC;UAAAiH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD;IAER;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,EAGLjB,oBAAoB,CAAC,CAAC;EAAA;IAAAc,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACpB,CAAC;AAEV,CAAC;AAAC3H,EAAA,CA34BID,SAAS;EAAA,QAYIL,OAAO;AAAA;AAAAiL,EAAA,GAZpB5K,SAAS;AA64Bf,eAAeA,SAAS;AAAC,IAAA4K,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}