{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vibhav\\\\Desktop\\\\library\\\\library-frontend\\\\src\\\\components\\\\Documents.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { documentAPI, categoryAPI } from '../services/api';\nimport { FileText, Search, ChevronDown, ChevronRight, Folder, FolderOpen, Eye, X, Star, Trash2, Menu, ArrowLeft } from 'lucide-react';\nimport { useAuth } from '../contexts/AuthContext';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Documents = () => {\n  _s();\n  var _selectedDocument$cat;\n  const [documents, setDocuments] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [expandedCategories, setExpandedCategories] = useState(new Set());\n  const [categoryTree, setCategoryTree] = useState([]);\n  const [categorizedDocuments, setCategorizedDocuments] = useState({});\n  const [selectedDocument, setSelectedDocument] = useState(null);\n  const [viewerLoading, setViewerLoading] = useState(false);\n  const [userFavorites, setUserFavorites] = useState(new Set());\n  const [deleteLoading, setDeleteLoading] = useState(null);\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n  const {\n    user\n  } = useAuth();\n  useEffect(() => {\n    loadData();\n  }, []);\n  useEffect(() => {\n    if (categories.length > 0 && documents.length > 0) {\n      organizeCategoriesAndDocuments();\n    }\n  }, [categories, documents, searchTerm]);\n\n  // Disable keyboard shortcuts when viewer is open\n  useEffect(() => {\n    const handleGlobalKeyDown = e => {\n      if (selectedDocument) {\n        // Disable Ctrl+S (Save), Ctrl+P (Print), F12 (DevTools)\n        if (e.ctrlKey && (e.key === 's' || e.key === 'p')) {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n        if (e.key === 'F12' || e.ctrlKey && e.shiftKey && e.key === 'I') {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n      }\n    };\n    if (selectedDocument) {\n      document.addEventListener('keydown', handleGlobalKeyDown, true);\n      // Disable right-click context menu\n      document.addEventListener('contextmenu', e => e.preventDefault());\n    }\n    return () => {\n      document.removeEventListener('keydown', handleGlobalKeyDown, true);\n      document.removeEventListener('contextmenu', e => e.preventDefault());\n    };\n  }, [selectedDocument]);\n  const loadData = async () => {\n    try {\n      const [docsResponse, categoriesResponse] = await Promise.all([documentAPI.getAll(), categoryAPI.getTree()]);\n      setDocuments(docsResponse);\n      setCategories(categoriesResponse);\n\n      // Load user favorites if student\n      if ((user === null || user === void 0 ? void 0 : user.role) === 'student') {\n        loadUserFavorites();\n      }\n    } catch (error) {\n      console.error('Error loading documents:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const loadUserFavorites = async () => {\n    try {\n      const favorites = await documentAPI.getFavorites();\n      const favoriteIds = new Set(favorites.map(doc => doc._id));\n      setUserFavorites(favoriteIds);\n    } catch (error) {\n      console.error('Error loading user favorites:', error);\n    }\n  };\n  const organizeCategoriesAndDocuments = () => {\n    if (!searchTerm) {\n      // No search term - show all documents grouped by category\n      const docsByCategory = {};\n      const uncategorizedDocs = [];\n      documents.forEach(doc => {\n        if (doc.category && doc.category._id) {\n          if (!docsByCategory[doc.category._id]) {\n            docsByCategory[doc.category._id] = [];\n          }\n          docsByCategory[doc.category._id].push(doc);\n        } else {\n          uncategorizedDocs.push(doc);\n        }\n      });\n      if (uncategorizedDocs.length > 0) {\n        docsByCategory['uncategorized'] = uncategorizedDocs;\n      }\n      setCategorizedDocuments(docsByCategory);\n      setCategoryTree(categories);\n      return;\n    }\n\n    // Search in both documents and categories\n    const searchLower = searchTerm.toLowerCase();\n\n    // Filter documents by title\n    const matchingDocs = documents.filter(doc => doc.title.toLowerCase().includes(searchLower));\n\n    // Filter categories by name (including nested categories)\n    const matchingCategoryIds = new Set();\n    const checkCategory = cat => {\n      if (cat.name.toLowerCase().includes(searchLower)) {\n        matchingCategoryIds.add(cat._id);\n        // Also add parent categories to show hierarchy\n        if (cat.parentCategory) {\n          matchingCategoryIds.add(cat.parentCategory);\n        }\n      }\n      if (cat.subcategories) {\n        cat.subcategories.forEach(checkCategory);\n      }\n    };\n    categories.forEach(checkCategory);\n\n    // Get documents from matching categories\n    const docsFromMatchingCategories = documents.filter(doc => doc.category && matchingCategoryIds.has(doc.category._id));\n\n    // Combine matching documents and documents from matching categories\n    const allMatchingDocs = [...new Set([...matchingDocs, ...docsFromMatchingCategories])];\n\n    // Group documents by category\n    const docsByCategory = {};\n    const uncategorizedDocs = [];\n    allMatchingDocs.forEach(doc => {\n      if (doc.category && doc.category._id) {\n        if (!docsByCategory[doc.category._id]) {\n          docsByCategory[doc.category._id] = [];\n        }\n        docsByCategory[doc.category._id].push(doc);\n      } else {\n        uncategorizedDocs.push(doc);\n      }\n    });\n\n    // Add uncategorized documents if any match the search\n    const matchingUncategorized = documents.filter(doc => !doc.category && doc.title.toLowerCase().includes(searchLower));\n    if (matchingUncategorized.length > 0) {\n      docsByCategory['uncategorized'] = matchingUncategorized;\n    }\n\n    // Filter category tree to only show categories that have matching documents or match the search\n    const filterCategoryTree = cats => {\n      return cats.filter(cat => {\n        const hasMatchingDocs = docsByCategory[cat._id] && docsByCategory[cat._id].length > 0;\n        const matchesSearch = cat.name.toLowerCase().includes(searchLower);\n        const hasMatchingSubcategories = cat.subcategories && filterCategoryTree(cat.subcategories).length > 0;\n        if (hasMatchingDocs || matchesSearch || hasMatchingSubcategories) {\n          // Filter subcategories recursively\n          if (cat.subcategories) {\n            cat.subcategories = filterCategoryTree(cat.subcategories);\n          }\n          return true;\n        }\n        return false;\n      });\n    };\n    const filteredCategoryTree = filterCategoryTree([...categories]);\n    setCategorizedDocuments(docsByCategory);\n    setCategoryTree(filteredCategoryTree);\n  };\n  const toggleCategory = categoryId => {\n    const newExpanded = new Set(expandedCategories);\n    if (newExpanded.has(categoryId)) {\n      newExpanded.delete(categoryId);\n    } else {\n      newExpanded.add(categoryId);\n    }\n    setExpandedCategories(newExpanded);\n  };\n  const handleViewDocument = async document => {\n    setSelectedDocument(document);\n    setViewerLoading(true);\n    setSidebarOpen(false); // Close mobile sidebar when viewing document\n\n    try {\n      // For Supabase, we can use the stored public URL directly\n      // But we still get the download URL for consistency and any future URL updates\n      const downloadData = await documentAPI.getDownloadUrl(document._id);\n      document.downloadUrl = downloadData.downloadUrl;\n      setSelectedDocument({\n        ...document\n      });\n    } catch (error) {\n      console.error('Error getting download URL:', error);\n      // Fallback to stored URL if API call fails\n      document.downloadUrl = document.fileUrl;\n      setSelectedDocument({\n        ...document\n      });\n    } finally {\n      setViewerLoading(false);\n    }\n  };\n  const toggleFavorite = async (documentId, event) => {\n    event.stopPropagation(); // Prevent triggering parent click events\n\n    try {\n      if (userFavorites.has(documentId)) {\n        await documentAPI.removeFromFavorites(documentId);\n        setUserFavorites(prev => {\n          const newSet = new Set(prev);\n          newSet.delete(documentId);\n          return newSet;\n        });\n      } else {\n        await documentAPI.addToFavorites(documentId);\n        setUserFavorites(prev => new Set([...prev, documentId]));\n      }\n    } catch (error) {\n      console.error('Error toggling favorite:', error);\n    }\n  };\n  const handleDeleteDocument = async (documentId, documentTitle, event) => {\n    event.stopPropagation(); // Prevent triggering parent click events\n\n    if (!window.confirm(`Are you sure you want to delete \"${documentTitle}\"?\\n\\nThis action cannot be undone and will remove the document from all users' favorites.`)) {\n      return;\n    }\n    setDeleteLoading(documentId);\n    try {\n      await documentAPI.delete(documentId);\n\n      // Update local state to remove the deleted document\n      setDocuments(prev => prev.filter(doc => doc._id !== documentId));\n\n      // Remove from favorites if it was favorited\n      setUserFavorites(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(documentId);\n        return newSet;\n      });\n\n      // Close viewer if the deleted document was being viewed\n      if (selectedDocument && selectedDocument._id === documentId) {\n        setSelectedDocument(null);\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('Error deleting document:', error);\n      alert(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Failed to delete document. Please try again.');\n    } finally {\n      setDeleteLoading(null);\n    }\n  };\n  const closeViewer = () => {\n    setSelectedDocument(null);\n  };\n  const getDocumentUrl = document => {\n    // For Supabase documents, prefer the download URL from API\n    if (document.downloadUrl) {\n      return document.downloadUrl;\n    }\n    // Fallback to stored public URL (Supabase URLs are public)\n    if (document.fileUrl) {\n      return document.fileUrl;\n    }\n    // Legacy fallback for old documents\n    if (document.filePath) {\n      return documentAPI.download(document.filePath);\n    }\n    return '';\n  };\n  const getFileExtension = document => {\n    var _filename$split$pop;\n    // Get extension from fileName (for S3 documents) or filePath (for legacy)\n    const filename = document.fileName || document.filePath || '';\n    return ((_filename$split$pop = filename.split('.').pop()) === null || _filename$split$pop === void 0 ? void 0 : _filename$split$pop.toLowerCase()) || '';\n  };\n  const renderDocumentViewer = () => {\n    if (!selectedDocument) return null;\n    const fileExtension = getFileExtension(selectedDocument);\n    const documentUrl = getDocumentUrl(selectedDocument);\n\n    // Disable keyboard shortcuts for print/save\n    const handleKeyDown = e => {\n      if (e.ctrlKey && (e.key === 's' || e.key === 'p')) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n      if (e.key === 'F12' || e.ctrlKey && e.shiftKey && e.key === 'I') {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",\n      onKeyDown: handleKeyDown,\n      tabIndex: -1,\n      style: {\n        outline: 'none'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-xl w-full h-full max-w-6xl max-h-full flex flex-col\",\n        style: {\n          WebkitUserSelect: 'none',\n          MozUserSelect: 'none',\n          msUserSelect: 'none',\n          userSelect: 'none'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between p-4 border-b\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3\",\n            children: [/*#__PURE__*/_jsxDEV(FileText, {\n              className: \"h-6 w-6 text-blue-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-medium text-gray-900\",\n                children: selectedDocument.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 347,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-gray-500\",\n                children: [\"Uploaded on \", new Date(selectedDocument.createdAt).toLocaleDateString(), selectedDocument.fileSize && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-2\",\n                  children: [\"\\u2022 \", (selectedDocument.fileSize / 1024 / 1024).toFixed(2), \" MB\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 353,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: closeViewer,\n            className: \"p-2 hover:bg-gray-100 rounded-full\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"h-6 w-6 text-gray-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 overflow-hidden\",\n          children: viewerLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-center h-full\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"ml-3 text-gray-600\",\n              children: \"Loading document...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 15\n          }, this) : !documentUrl ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-center h-full\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center\",\n              children: [/*#__PURE__*/_jsxDEV(FileText, {\n                className: \"h-16 w-16 text-gray-400 mx-auto mb-4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 378,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"text-lg font-medium text-gray-900 mb-2\",\n                children: \"Document not available\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 379,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-500\",\n                children: \"Unable to load document. Please try again later.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 382,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 377,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-full w-full\",\n            children: ['pdf'].includes(fileExtension) ? /*#__PURE__*/_jsxDEV(\"iframe\", {\n              src: `${documentUrl}#toolbar=0&navpanes=0&scrollbar=1&view=FitH`,\n              className: \"w-full h-full border-0\",\n              title: selectedDocument.title,\n              style: {\n                userSelect: 'none',\n                WebkitUserSelect: 'none',\n                MozUserSelect: 'none',\n                msUserSelect: 'none'\n              },\n              onLoad: e => {\n                var _e$target$contentDocu, _e$target$contentDocu2;\n                // Disable right-click context menu\n                (_e$target$contentDocu = e.target.contentDocument) === null || _e$target$contentDocu === void 0 ? void 0 : _e$target$contentDocu.addEventListener('contextmenu', event => {\n                  event.preventDefault();\n                });\n                // Disable keyboard shortcuts\n                (_e$target$contentDocu2 = e.target.contentDocument) === null || _e$target$contentDocu2 === void 0 ? void 0 : _e$target$contentDocu2.addEventListener('keydown', event => {\n                  if (event.ctrlKey && (event.key === 's' || event.key === 'p')) {\n                    event.preventDefault();\n                  }\n                });\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 19\n            }, this) : ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp'].includes(fileExtension) ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-full flex items-center justify-center bg-gray-50 overflow-auto\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: documentUrl,\n                alt: selectedDocument.title,\n                className: \"max-w-full max-h-full object-contain\",\n                style: {\n                  userSelect: 'none',\n                  WebkitUserSelect: 'none',\n                  MozUserSelect: 'none',\n                  msUserSelect: 'none'\n                },\n                onContextMenu: e => e.preventDefault(),\n                draggable: false\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 19\n            }, this) : ['txt', 'md', 'csv'].includes(fileExtension) ? /*#__PURE__*/_jsxDEV(\"iframe\", {\n              src: documentUrl,\n              className: \"w-full h-full border-0\",\n              title: selectedDocument.title,\n              style: {\n                userSelect: 'none',\n                WebkitUserSelect: 'none',\n                MozUserSelect: 'none',\n                msUserSelect: 'none'\n              },\n              onLoad: e => {\n                var _e$target$contentDocu3, _e$target$contentDocu4;\n                // Disable right-click context menu\n                (_e$target$contentDocu3 = e.target.contentDocument) === null || _e$target$contentDocu3 === void 0 ? void 0 : _e$target$contentDocu3.addEventListener('contextmenu', event => {\n                  event.preventDefault();\n                });\n                // Disable keyboard shortcuts\n                (_e$target$contentDocu4 = e.target.contentDocument) === null || _e$target$contentDocu4 === void 0 ? void 0 : _e$target$contentDocu4.addEventListener('keydown', event => {\n                  if (event.ctrlKey && (event.key === 's' || event.key === 'p')) {\n                    event.preventDefault();\n                  }\n                });\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 19\n            }, this) : ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'].includes(fileExtension) ? /*#__PURE__*/_jsxDEV(\"iframe\", {\n              src: `https://docs.google.com/viewer?url=${encodeURIComponent(documentUrl)}&embedded=true&chrome=false&dov=1`,\n              className: \"w-full h-full border-0\",\n              title: selectedDocument.title,\n              style: {\n                userSelect: 'none',\n                WebkitUserSelect: 'none',\n                MozUserSelect: 'none',\n                msUserSelect: 'none'\n              },\n              onLoad: e => {\n                var _e$target$contentDocu5;\n                // Disable right-click context menu\n                (_e$target$contentDocu5 = e.target.contentDocument) === null || _e$target$contentDocu5 === void 0 ? void 0 : _e$target$contentDocu5.addEventListener('contextmenu', event => {\n                  event.preventDefault();\n                });\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"h-full flex items-center justify-center bg-gray-50\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center\",\n                children: [/*#__PURE__*/_jsxDEV(FileText, {\n                  className: \"h-16 w-16 text-gray-400 mx-auto mb-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 474,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-lg font-medium text-gray-900 mb-2\",\n                  children: \"Preview not available\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 475,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-gray-500\",\n                  children: [\"This file type (\", fileExtension, \") cannot be previewed directly.\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 478,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 473,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 472,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 7\n    }, this);\n  };\n  const highlightText = (text, searchTerm) => {\n    if (!searchTerm) return text;\n    const parts = text.split(new RegExp(`(${searchTerm})`, 'gi'));\n    return parts.map((part, index) => part.toLowerCase() === searchTerm.toLowerCase() ? /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"bg-yellow-200 font-semibold\",\n      children: part\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 498,\n      columnNumber: 9\n    }, this) : part);\n  };\n  const renderCategory = (category, level = 0) => {\n    const isExpanded = expandedCategories.has(category._id);\n    const hasDocuments = categorizedDocuments[category._id] && categorizedDocuments[category._id].length > 0;\n    const hasSubcategories = category.subcategories && category.subcategories.length > 0;\n    const hasContent = hasDocuments || hasSubcategories;\n    const matchesSearch = searchTerm && category.name.toLowerCase().includes(searchTerm.toLowerCase());\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-l-2 border-gray-200\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex items-center py-2 px-3 sm:px-4 hover:bg-gray-50 cursor-pointer ${matchesSearch ? 'bg-yellow-50' : level === 0 ? 'bg-gray-100' : level === 1 ? 'bg-gray-50' : 'bg-white'}`,\n        style: {\n          paddingLeft: `${12 + level * 16}px`\n        },\n        onClick: () => hasContent && toggleCategory(category._id),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2 flex-1 min-w-0\",\n          children: [hasContent ? isExpanded ? /*#__PURE__*/_jsxDEV(ChevronDown, {\n            className: \"h-4 w-4 text-gray-500 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 523,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(ChevronRight, {\n            className: \"h-4 w-4 text-gray-500 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 528,\n            columnNumber: 15\n          }, this), isExpanded ? /*#__PURE__*/_jsxDEV(FolderOpen, {\n            className: \"h-4 w-4 sm:h-5 sm:w-5 text-blue-500 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 532,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(Folder, {\n            className: \"h-4 w-4 sm:h-5 sm:w-5 text-gray-500 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 534,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: `font-medium text-sm sm:text-base truncate ${level === 0 ? 'text-gray-900' : level === 1 ? 'text-gray-800' : 'text-gray-700'}`,\n            children: highlightText(category.name, searchTerm)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 520,\n          columnNumber: 11\n        }, this), hasDocuments && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 flex-shrink-0\",\n          children: categorizedDocuments[category._id].length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 545,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 512,\n        columnNumber: 9\n      }, this), isExpanded && hasContent && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ml-4\",\n        children: [hasDocuments && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-1 mb-2\",\n          children: categorizedDocuments[category._id].map(document => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between py-2 px-3 sm:px-4 hover:bg-blue-50 rounded-md mx-1 sm:mx-2\",\n            style: {\n              paddingLeft: `${12 + (level + 1) * 16}px`\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: `flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0 ${(user === null || user === void 0 ? void 0 : user.role) === 'student' ? 'cursor-pointer hover:bg-blue-100 rounded-md p-1 -m-1 transition-colors' : ''}`,\n              onClick: (user === null || user === void 0 ? void 0 : user.role) === 'student' ? () => handleViewDocument(document) : undefined,\n              title: (user === null || user === void 0 ? void 0 : user.role) === 'student' ? 'Click to view document' : '',\n              children: [/*#__PURE__*/_jsxDEV(FileText, {\n                className: \"h-4 w-4 text-blue-600 flex-shrink-0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 569,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"min-w-0 flex-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: `text-xs sm:text-sm font-medium truncate ${(user === null || user === void 0 ? void 0 : user.role) === 'student' ? 'text-blue-700 hover:text-blue-800' : 'text-blue-600'}`,\n                  children: highlightText(document.title, searchTerm)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 571,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-500 hidden sm:block\",\n                  children: new Date(document.createdAt).toLocaleDateString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 576,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 570,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-1 sm:space-x-2 flex-shrink-0\",\n              children: [(user === null || user === void 0 ? void 0 : user.role) === 'student' && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: e => toggleFavorite(document._id, e),\n                className: \"p-1 hover:bg-gray-100 rounded-full\",\n                title: userFavorites.has(document._id) ? 'Remove from favorites' : 'Add to favorites',\n                children: /*#__PURE__*/_jsxDEV(Star, {\n                  className: `h-3 w-3 sm:h-4 sm:w-4 ${userFavorites.has(document._id) ? 'text-yellow-500 fill-yellow-500' : 'text-gray-400 hover:text-yellow-500'}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 588,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 583,\n                columnNumber: 25\n              }, this), ((user === null || user === void 0 ? void 0 : user.role) === 'admin' || (user === null || user === void 0 ? void 0 : user.role) === 'superadmin') && /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handleViewDocument(document),\n                  className: \"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\",\n                  children: [/*#__PURE__*/_jsxDEV(Eye, {\n                    className: \"h-3 w-3 mr-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 603,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"hidden sm:inline\",\n                    children: \"View\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 604,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 599,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: e => handleDeleteDocument(document._id, document.title, e),\n                  disabled: deleteLoading === document._id,\n                  className: \"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\",\n                  title: \"Delete document\",\n                  children: [deleteLoading === document._id ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"h-3 w-3 animate-spin rounded-full border border-red-700 border-t-transparent mr-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 613,\n                    columnNumber: 31\n                  }, this) : /*#__PURE__*/_jsxDEV(Trash2, {\n                    className: \"h-3 w-3 mr-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 615,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"hidden sm:inline\",\n                    children: deleteLoading === document._id ? 'Deleting...' : 'Delete'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 617,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 606,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 581,\n              columnNumber: 21\n            }, this)]\n          }, document._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 557,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 15\n        }, this), hasSubcategories && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: category.subcategories.map(subcategory => renderCategory(subcategory, level + 1))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 631,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 552,\n        columnNumber: 11\n      }, this)]\n    }, category._id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 7\n    }, this);\n  };\n  const renderUncategorizedDocuments = () => {\n    const uncategorizedDocs = categorizedDocuments['uncategorized'];\n    if (!uncategorizedDocs || uncategorizedDocs.length === 0) return null;\n    const isExpanded = expandedCategories.has('uncategorized');\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-l-2 border-gray-200\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center py-2 px-3 sm:px-4 hover:bg-gray-50 cursor-pointer bg-gray-100\",\n        onClick: () => toggleCategory('uncategorized'),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2 flex-1 min-w-0\",\n          children: [isExpanded ? /*#__PURE__*/_jsxDEV(ChevronDown, {\n            className: \"h-4 w-4 text-gray-500 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 659,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(ChevronRight, {\n            className: \"h-4 w-4 text-gray-500 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 661,\n            columnNumber: 15\n          }, this), isExpanded ? /*#__PURE__*/_jsxDEV(FolderOpen, {\n            className: \"h-4 w-4 sm:h-5 sm:w-5 text-gray-500 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 665,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(Folder, {\n            className: \"h-4 w-4 sm:h-5 sm:w-5 text-gray-500 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 667,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-medium text-sm sm:text-base text-gray-900 truncate\",\n            children: \"Uncategorized\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 670,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 657,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 flex-shrink-0\",\n          children: uncategorizedDocs.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 675,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 653,\n        columnNumber: 9\n      }, this), isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ml-4 space-y-1 mb-2\",\n        children: uncategorizedDocs.map(document => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between py-2 px-3 sm:px-4 hover:bg-blue-50 rounded-md mx-1 sm:mx-2\",\n          style: {\n            paddingLeft: '32px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0 ${(user === null || user === void 0 ? void 0 : user.role) === 'student' ? 'cursor-pointer hover:bg-blue-100 rounded-md p-1 -m-1 transition-colors' : ''}`,\n            onClick: (user === null || user === void 0 ? void 0 : user.role) === 'student' ? () => handleViewDocument(document) : undefined,\n            title: (user === null || user === void 0 ? void 0 : user.role) === 'student' ? 'Click to view document' : '',\n            children: [/*#__PURE__*/_jsxDEV(FileText, {\n              className: \"h-4 w-4 text-blue-600 flex-shrink-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 695,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"min-w-0 flex-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: `text-xs sm:text-sm font-medium truncate ${(user === null || user === void 0 ? void 0 : user.role) === 'student' ? 'text-blue-700 hover:text-blue-800' : 'text-blue-600'}`,\n                children: highlightText(document.title, searchTerm)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 697,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-500 hidden sm:block\",\n                children: new Date(document.createdAt).toLocaleDateString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 702,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 696,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 688,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-1 sm:space-x-2 flex-shrink-0\",\n            children: [(user === null || user === void 0 ? void 0 : user.role) === 'student' && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: e => toggleFavorite(document._id, e),\n              className: \"p-1 hover:bg-gray-100 rounded-full\",\n              title: userFavorites.has(document._id) ? 'Remove from favorites' : 'Add to favorites',\n              children: /*#__PURE__*/_jsxDEV(Star, {\n                className: `h-3 w-3 sm:h-4 sm:w-4 ${userFavorites.has(document._id) ? 'text-yellow-500 fill-yellow-500' : 'text-gray-400 hover:text-yellow-500'}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 714,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 709,\n              columnNumber: 21\n            }, this), ((user === null || user === void 0 ? void 0 : user.role) === 'admin' || (user === null || user === void 0 ? void 0 : user.role) === 'superadmin') && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleViewDocument(document),\n                className: \"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\",\n                children: [/*#__PURE__*/_jsxDEV(Eye, {\n                  className: \"h-3 w-3 mr-1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 729,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"hidden sm:inline\",\n                  children: \"View\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 730,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 725,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: e => handleDeleteDocument(document._id, document.title, e),\n                disabled: deleteLoading === document._id,\n                className: \"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\",\n                title: \"Delete document\",\n                children: [deleteLoading === document._id ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"h-3 w-3 animate-spin rounded-full border border-red-700 border-t-transparent mr-1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 739,\n                  columnNumber: 27\n                }, this) : /*#__PURE__*/_jsxDEV(Trash2, {\n                  className: \"h-3 w-3 mr-1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 741,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"hidden sm:inline\",\n                  children: deleteLoading === document._id ? 'Deleting...' : 'Delete'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 743,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 732,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 707,\n            columnNumber: 17\n          }, this)]\n        }, document._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 683,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 681,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 652,\n      columnNumber: 7\n    }, this);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center h-64\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 761,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 760,\n      columnNumber: 7\n    }, this);\n  }\n  const getTotalMatchingDocuments = () => {\n    if (!searchTerm) return documents.length;\n    const searchLower = searchTerm.toLowerCase();\n\n    // Documents matching by title\n    const matchingDocs = documents.filter(doc => doc.title.toLowerCase().includes(searchLower));\n\n    // Documents from matching categories\n    const matchingCategoryIds = new Set();\n    const checkCategory = cat => {\n      if (cat.name.toLowerCase().includes(searchLower)) {\n        matchingCategoryIds.add(cat._id);\n      }\n      if (cat.subcategories) {\n        cat.subcategories.forEach(checkCategory);\n      }\n    };\n    categories.forEach(checkCategory);\n    const docsFromMatchingCategories = documents.filter(doc => doc.category && matchingCategoryIds.has(doc.category._id));\n\n    // Combine and deduplicate\n    const allMatchingDocs = [...new Set([...matchingDocs, ...docsFromMatchingCategories])];\n    return allMatchingDocs.length;\n  };\n  const totalDocuments = getTotalMatchingDocuments();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-full\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between flex-shrink-0\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-semibold text-gray-900\",\n          children: \"Document Library\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 804,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500 mt-1\",\n          children: \"Browse and view documents organized by categories\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 805,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 803,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 802,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex h-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full sm:w-96 lg:w-80 xl:w-96 bg-white border-r border-gray-200 flex flex-col\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between px-3 py-2 border-b border-gray-200 flex-shrink-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-base font-semibold text-gray-900\",\n            children: \"Categories\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 816,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setSidebarOpen(false),\n            className: \"lg:hidden p-1 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"h-4 w-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 821,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 817,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 815,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-3 border-b border-gray-200 flex-shrink-0\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\",\n              children: /*#__PURE__*/_jsxDEV(Search, {\n                className: \"h-4 w-4 text-gray-400\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 829,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 828,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: searchTerm,\n              onChange: e => setSearchTerm(e.target.value),\n              className: \"focus:ring-blue-500 focus:border-blue-500 block w-full pl-9 py-1.5 text-sm border-gray-300 rounded-md\",\n              placeholder: \"Search documents...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 831,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 827,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 826,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"px-3 py-2 border-b border-gray-200 flex-shrink-0\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-600\",\n              children: searchTerm ? `Found ${totalDocuments} docs` : `${totalDocuments} docs`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 844,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setExpandedCategories(new Set()),\n                className: \"text-xs text-gray-500 hover:text-gray-700\",\n                children: \"Collapse\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 851,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-300\",\n                children: \"|\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 857,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  const allIds = new Set();\n                  const addIds = cats => {\n                    cats.forEach(cat => {\n                      var _cat$subcategories;\n                      if (categorizedDocuments[cat._id] || ((_cat$subcategories = cat.subcategories) === null || _cat$subcategories === void 0 ? void 0 : _cat$subcategories.length) > 0) {\n                        allIds.add(cat._id);\n                      }\n                      if (cat.subcategories) {\n                        addIds(cat.subcategories);\n                      }\n                    });\n                  };\n                  addIds(categoryTree);\n                  if (categorizedDocuments['uncategorized']) {\n                    allIds.add('uncategorized');\n                  }\n                  setExpandedCategories(allIds);\n                },\n                className: \"text-xs text-blue-600 hover:text-blue-800\",\n                children: \"Expand\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 858,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 850,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 843,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 842,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 overflow-y-auto sidebar-scroll\",\n          children: categoryTree.length > 0 || categorizedDocuments['uncategorized'] ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"divide-y divide-gray-100\",\n            children: [categoryTree.map(category => renderCategory(category)), renderUncategorizedDocuments()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 888,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col items-center justify-center h-full p-4 text-center\",\n            children: [/*#__PURE__*/_jsxDEV(FileText, {\n              className: \"h-8 w-8 sm:h-12 sm:w-12 text-gray-400 mb-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 894,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-sm font-medium text-gray-900 mb-2\",\n              children: \"No documents found\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 895,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs sm:text-sm text-gray-500\",\n              children: searchTerm ? 'Try adjusting your search criteria.' : 'No documents have been uploaded yet.'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 896,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 893,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 886,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 812,\n        columnNumber: 9\n      }, this), sidebarOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lg:hidden fixed inset-0 z-40 bg-black bg-opacity-50 transition-opacity duration-300\",\n        onClick: () => setSidebarOpen(false),\n        \"aria-hidden\": \"true\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 908,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 flex flex-col min-w-0 bg-white\",\n        children: selectedDocument ?\n        /*#__PURE__*/\n        /* Document Viewer */\n        _jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white border-b border-gray-200 px-2 sm:px-4 py-2 flex items-center justify-between flex-shrink-0\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center min-w-0 flex-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setSelectedDocument(null),\n                className: \"mr-2 p-1 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100\",\n                children: /*#__PURE__*/_jsxDEV(ArrowLeft, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 927,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 923,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"min-w-0 flex-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                  className: \"text-sm sm:text-base font-semibold text-gray-900 truncate\",\n                  children: selectedDocument.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 930,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-500 truncate hidden sm:block\",\n                  children: [((_selectedDocument$cat = selectedDocument.category) === null || _selectedDocument$cat === void 0 ? void 0 : _selectedDocument$cat.name) || 'Uncategorized', \" \\u2022\", new Date(selectedDocument.createdAt).toLocaleDateString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 933,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 929,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 922,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-1 ml-2 flex-shrink-0\",\n              children: [(user === null || user === void 0 ? void 0 : user.role) === 'student' && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => toggleFavorite(selectedDocument._id),\n                className: \"p-1 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100\",\n                title: userFavorites.has(selectedDocument._id) ? 'Remove from favorites' : 'Add to favorites',\n                children: /*#__PURE__*/_jsxDEV(Star, {\n                  className: `h-4 w-4 ${userFavorites.has(selectedDocument._id) ? 'text-yellow-500 fill-yellow-500' : 'text-gray-400 hover:text-yellow-500'}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 947,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 942,\n                columnNumber: 21\n              }, this), ((user === null || user === void 0 ? void 0 : user.role) === 'admin' || (user === null || user === void 0 ? void 0 : user.role) === 'superadmin') && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleDeleteDocument(selectedDocument._id, selectedDocument.title),\n                disabled: deleteLoading === selectedDocument._id,\n                className: \"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\",\n                title: \"Delete document\",\n                children: [deleteLoading === selectedDocument._id ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"h-3 w-3 animate-spin rounded-full border border-red-700 border-t-transparent mr-1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 964,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(Trash2, {\n                  className: \"h-3 w-3 mr-1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 966,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"hidden sm:inline\",\n                  children: deleteLoading === selectedDocument._id ? 'Deleting...' : 'Delete'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 968,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 957,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setSelectedDocument(null),\n                className: \"p-1 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 lg:hidden\",\n                children: /*#__PURE__*/_jsxDEV(X, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 977,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 973,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 940,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 921,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 min-h-0\",\n            children: viewerLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-center h-full bg-gray-50\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 987,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mt-2 text-sm text-gray-500\",\n                  children: \"Loading document...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 988,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 986,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 985,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"iframe\", {\n              src: selectedDocument.downloadUrl,\n              className: \"w-full h-full border-0 bg-white\",\n              title: selectedDocument.title,\n              style: {\n                minHeight: '100%'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 992,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 983,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true) :\n        /*#__PURE__*/\n        /* Welcome Screen */\n        _jsxDEV(\"div\", {\n          className: \"flex-1 flex items-center justify-center bg-gray-50 p-4\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center max-w-md\",\n            children: [/*#__PURE__*/_jsxDEV(FileText, {\n              className: \"mx-auto h-12 w-12 sm:h-16 sm:w-16 text-gray-400 mb-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1005,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-lg sm:text-xl font-semibold text-gray-900 mb-2\",\n              children: \"Document Library\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1006,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm sm:text-base text-gray-600 mb-6\",\n              children: \"Browse and view documents organized by categories.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1007,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lg:hidden\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-blue-800 mb-3\",\n                  children: \"Tap the menu button above to browse categories and documents\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1014,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center\",\n                  children: [/*#__PURE__*/_jsxDEV(Menu, {\n                    className: \"h-5 w-5 text-blue-600 mr-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1018,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-sm font-medium text-blue-600\",\n                    children: \"Categories Menu\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1019,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1017,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1013,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setSidebarOpen(true),\n                className: \"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 shadow-sm\",\n                children: [/*#__PURE__*/_jsxDEV(Menu, {\n                  className: \"h-5 w-5 mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1026,\n                  columnNumber: 21\n                }, this), \"Browse Documents\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1022,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1012,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"hidden lg:block text-sm text-gray-500\",\n              children: \"Select a document from the sidebar to view it here.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1032,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1004,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1003,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 916,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 810,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 800,\n    columnNumber: 5\n  }, this);\n};\n_s(Documents, \"7MYe71IXQE8sC3LusViJXY8Tlic=\", false, function () {\n  return [useAuth];\n});\n_c = Documents;\nexport default Documents;\nvar _c;\n$RefreshReg$(_c, \"Documents\");","map":{"version":3,"names":["React","useState","useEffect","documentAPI","categoryAPI","FileText","Search","ChevronDown","ChevronRight","Folder","FolderOpen","Eye","X","Star","Trash2","Menu","ArrowLeft","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","Documents","_s","_selectedDocument$cat","documents","setDocuments","categories","setCategories","loading","setLoading","searchTerm","setSearchTerm","expandedCategories","setExpandedCategories","Set","categoryTree","setCategoryTree","categorizedDocuments","setCategorizedDocuments","selectedDocument","setSelectedDocument","viewerLoading","setViewerLoading","userFavorites","setUserFavorites","deleteLoading","setDeleteLoading","sidebarOpen","setSidebarOpen","user","loadData","length","organizeCategoriesAndDocuments","handleGlobalKeyDown","e","ctrlKey","key","preventDefault","stopPropagation","shiftKey","document","addEventListener","removeEventListener","docsResponse","categoriesResponse","Promise","all","getAll","getTree","role","loadUserFavorites","error","console","favorites","getFavorites","favoriteIds","map","doc","_id","docsByCategory","uncategorizedDocs","forEach","category","push","searchLower","toLowerCase","matchingDocs","filter","title","includes","matchingCategoryIds","checkCategory","cat","name","add","parentCategory","subcategories","docsFromMatchingCategories","has","allMatchingDocs","matchingUncategorized","filterCategoryTree","cats","hasMatchingDocs","matchesSearch","hasMatchingSubcategories","filteredCategoryTree","toggleCategory","categoryId","newExpanded","delete","handleViewDocument","downloadData","getDownloadUrl","downloadUrl","fileUrl","toggleFavorite","documentId","event","removeFromFavorites","prev","newSet","addToFavorites","handleDeleteDocument","documentTitle","window","confirm","_error$response","_error$response$data","alert","response","data","message","closeViewer","getDocumentUrl","filePath","download","getFileExtension","_filename$split$pop","filename","fileName","split","pop","renderDocumentViewer","fileExtension","documentUrl","handleKeyDown","className","onKeyDown","tabIndex","style","outline","children","WebkitUserSelect","MozUserSelect","msUserSelect","userSelect","_jsxFileName","lineNumber","columnNumber","Date","createdAt","toLocaleDateString","fileSize","toFixed","onClick","src","onLoad","_e$target$contentDocu","_e$target$contentDocu2","target","contentDocument","alt","onContextMenu","draggable","_e$target$contentDocu3","_e$target$contentDocu4","encodeURIComponent","_e$target$contentDocu5","highlightText","text","parts","RegExp","part","index","renderCategory","level","isExpanded","hasDocuments","hasSubcategories","hasContent","paddingLeft","undefined","disabled","subcategory","renderUncategorizedDocuments","getTotalMatchingDocuments","totalDocuments","type","value","onChange","placeholder","allIds","addIds","_cat$subcategories","minHeight","_c","$RefreshReg$"],"sources":["C:/Users/vibhav/Desktop/library/library-frontend/src/components/Documents.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { documentAPI, categoryAPI } from '../services/api';\r\nimport { FileText, Search, ChevronDown, ChevronRight, Folder, FolderOpen, Eye, X, Star, Trash2, Menu, ArrowLeft } from 'lucide-react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\nconst Documents = () => {\r\n  const [documents, setDocuments] = useState([]);\r\n  const [categories, setCategories] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [expandedCategories, setExpandedCategories] = useState(new Set());\r\n  const [categoryTree, setCategoryTree] = useState([]);\r\n  const [categorizedDocuments, setCategorizedDocuments] = useState({});\r\n  const [selectedDocument, setSelectedDocument] = useState(null);\r\n  const [viewerLoading, setViewerLoading] = useState(false);\r\n  const [userFavorites, setUserFavorites] = useState(new Set());\r\n  const [deleteLoading, setDeleteLoading] = useState(null);\r\n  const [sidebarOpen, setSidebarOpen] = useState(false);\r\n  \r\n  const { user } = useAuth();\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (categories.length > 0 && documents.length > 0) {\r\n      organizeCategoriesAndDocuments();\r\n    }\r\n  }, [categories, documents, searchTerm]);\r\n\r\n  // Disable keyboard shortcuts when viewer is open\r\n  useEffect(() => {\r\n    const handleGlobalKeyDown = (e) => {\r\n      if (selectedDocument) {\r\n        // Disable Ctrl+S (Save), Ctrl+P (Print), F12 (DevTools)\r\n        if (e.ctrlKey && (e.key === 's' || e.key === 'p')) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n        }\r\n        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n        }\r\n      }\r\n    };\r\n\r\n    if (selectedDocument) {\r\n      document.addEventListener('keydown', handleGlobalKeyDown, true);\r\n      // Disable right-click context menu\r\n      document.addEventListener('contextmenu', (e) => e.preventDefault());\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleGlobalKeyDown, true);\r\n      document.removeEventListener('contextmenu', (e) => e.preventDefault());\r\n    };\r\n  }, [selectedDocument]);\r\n\r\n  const loadData = async () => {\r\n    try {\r\n      const [docsResponse, categoriesResponse] = await Promise.all([\r\n        documentAPI.getAll(),\r\n        categoryAPI.getTree(),\r\n      ]);\r\n      \r\n      setDocuments(docsResponse);\r\n      setCategories(categoriesResponse);\r\n      \r\n      // Load user favorites if student\r\n      if (user?.role === 'student') {\r\n        loadUserFavorites();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading documents:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadUserFavorites = async () => {\r\n    try {\r\n      const favorites = await documentAPI.getFavorites();\r\n      const favoriteIds = new Set(favorites.map(doc => doc._id));\r\n      setUserFavorites(favoriteIds);\r\n    } catch (error) {\r\n      console.error('Error loading user favorites:', error);\r\n    }\r\n  };\r\n\r\n  const organizeCategoriesAndDocuments = () => {\r\n    if (!searchTerm) {\r\n      // No search term - show all documents grouped by category\r\n      const docsByCategory = {};\r\n      const uncategorizedDocs = [];\r\n\r\n      documents.forEach(doc => {\r\n        if (doc.category && doc.category._id) {\r\n          if (!docsByCategory[doc.category._id]) {\r\n            docsByCategory[doc.category._id] = [];\r\n          }\r\n          docsByCategory[doc.category._id].push(doc);\r\n        } else {\r\n          uncategorizedDocs.push(doc);\r\n        }\r\n      });\r\n\r\n      if (uncategorizedDocs.length > 0) {\r\n        docsByCategory['uncategorized'] = uncategorizedDocs;\r\n      }\r\n\r\n      setCategorizedDocuments(docsByCategory);\r\n      setCategoryTree(categories);\r\n      return;\r\n    }\r\n\r\n    // Search in both documents and categories\r\n    const searchLower = searchTerm.toLowerCase();\r\n    \r\n    // Filter documents by title\r\n    const matchingDocs = documents.filter(doc =>\r\n      doc.title.toLowerCase().includes(searchLower)\r\n    );\r\n\r\n    // Filter categories by name (including nested categories)\r\n    const matchingCategoryIds = new Set();\r\n    const checkCategory = (cat) => {\r\n      if (cat.name.toLowerCase().includes(searchLower)) {\r\n        matchingCategoryIds.add(cat._id);\r\n        // Also add parent categories to show hierarchy\r\n        if (cat.parentCategory) {\r\n          matchingCategoryIds.add(cat.parentCategory);\r\n        }\r\n      }\r\n      if (cat.subcategories) {\r\n        cat.subcategories.forEach(checkCategory);\r\n      }\r\n    };\r\n    categories.forEach(checkCategory);\r\n\r\n    // Get documents from matching categories\r\n    const docsFromMatchingCategories = documents.filter(doc => \r\n      doc.category && matchingCategoryIds.has(doc.category._id)\r\n    );\r\n\r\n    // Combine matching documents and documents from matching categories\r\n    const allMatchingDocs = [...new Set([...matchingDocs, ...docsFromMatchingCategories])];\r\n\r\n    // Group documents by category\r\n    const docsByCategory = {};\r\n    const uncategorizedDocs = [];\r\n\r\n    allMatchingDocs.forEach(doc => {\r\n      if (doc.category && doc.category._id) {\r\n        if (!docsByCategory[doc.category._id]) {\r\n          docsByCategory[doc.category._id] = [];\r\n        }\r\n        docsByCategory[doc.category._id].push(doc);\r\n      } else {\r\n        uncategorizedDocs.push(doc);\r\n      }\r\n    });\r\n\r\n    // Add uncategorized documents if any match the search\r\n    const matchingUncategorized = documents.filter(doc => \r\n      !doc.category && doc.title.toLowerCase().includes(searchLower)\r\n    );\r\n    if (matchingUncategorized.length > 0) {\r\n      docsByCategory['uncategorized'] = matchingUncategorized;\r\n    }\r\n\r\n    // Filter category tree to only show categories that have matching documents or match the search\r\n    const filterCategoryTree = (cats) => {\r\n      return cats.filter(cat => {\r\n        const hasMatchingDocs = docsByCategory[cat._id] && docsByCategory[cat._id].length > 0;\r\n        const matchesSearch = cat.name.toLowerCase().includes(searchLower);\r\n        const hasMatchingSubcategories = cat.subcategories && filterCategoryTree(cat.subcategories).length > 0;\r\n        \r\n        if (hasMatchingDocs || matchesSearch || hasMatchingSubcategories) {\r\n          // Filter subcategories recursively\r\n          if (cat.subcategories) {\r\n            cat.subcategories = filterCategoryTree(cat.subcategories);\r\n          }\r\n          return true;\r\n        }\r\n        return false;\r\n      });\r\n    };\r\n\r\n    const filteredCategoryTree = filterCategoryTree([...categories]);\r\n\r\n    setCategorizedDocuments(docsByCategory);\r\n    setCategoryTree(filteredCategoryTree);\r\n  };\r\n\r\n  const toggleCategory = (categoryId) => {\r\n    const newExpanded = new Set(expandedCategories);\r\n    if (newExpanded.has(categoryId)) {\r\n      newExpanded.delete(categoryId);\r\n    } else {\r\n      newExpanded.add(categoryId);\r\n    }\r\n    setExpandedCategories(newExpanded);\r\n  };\r\n\r\n  const handleViewDocument = async (document) => {\r\n    setSelectedDocument(document);\r\n    setViewerLoading(true);\r\n    setSidebarOpen(false); // Close mobile sidebar when viewing document\r\n    \r\n    try {\r\n      // For Supabase, we can use the stored public URL directly\r\n      // But we still get the download URL for consistency and any future URL updates\r\n      const downloadData = await documentAPI.getDownloadUrl(document._id);\r\n      document.downloadUrl = downloadData.downloadUrl;\r\n      setSelectedDocument({...document});\r\n    } catch (error) {\r\n      console.error('Error getting download URL:', error);\r\n      // Fallback to stored URL if API call fails\r\n      document.downloadUrl = document.fileUrl;\r\n      setSelectedDocument({...document});\r\n    } finally {\r\n      setViewerLoading(false);\r\n    }\r\n  };\r\n\r\n  const toggleFavorite = async (documentId, event) => {\r\n    event.stopPropagation(); // Prevent triggering parent click events\r\n    \r\n    try {\r\n      if (userFavorites.has(documentId)) {\r\n        await documentAPI.removeFromFavorites(documentId);\r\n        setUserFavorites(prev => {\r\n          const newSet = new Set(prev);\r\n          newSet.delete(documentId);\r\n          return newSet;\r\n        });\r\n      } else {\r\n        await documentAPI.addToFavorites(documentId);\r\n        setUserFavorites(prev => new Set([...prev, documentId]));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error toggling favorite:', error);\r\n    }\r\n  };\r\n\r\n  const handleDeleteDocument = async (documentId, documentTitle, event) => {\r\n    event.stopPropagation(); // Prevent triggering parent click events\r\n    \r\n    if (!window.confirm(`Are you sure you want to delete \"${documentTitle}\"?\\n\\nThis action cannot be undone and will remove the document from all users' favorites.`)) {\r\n      return;\r\n    }\r\n\r\n    setDeleteLoading(documentId);\r\n    \r\n    try {\r\n      await documentAPI.delete(documentId);\r\n      \r\n      // Update local state to remove the deleted document\r\n      setDocuments(prev => prev.filter(doc => doc._id !== documentId));\r\n      \r\n      // Remove from favorites if it was favorited\r\n      setUserFavorites(prev => {\r\n        const newSet = new Set(prev);\r\n        newSet.delete(documentId);\r\n        return newSet;\r\n      });\r\n      \r\n      // Close viewer if the deleted document was being viewed\r\n      if (selectedDocument && selectedDocument._id === documentId) {\r\n        setSelectedDocument(null);\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Error deleting document:', error);\r\n      alert(error.response?.data?.message || 'Failed to delete document. Please try again.');\r\n    } finally {\r\n      setDeleteLoading(null);\r\n    }\r\n  };\r\n\r\n  const closeViewer = () => {\r\n    setSelectedDocument(null);\r\n  };\r\n\r\n  const getDocumentUrl = (document) => {\r\n    // For Supabase documents, prefer the download URL from API\r\n    if (document.downloadUrl) {\r\n      return document.downloadUrl;\r\n    }\r\n    // Fallback to stored public URL (Supabase URLs are public)\r\n    if (document.fileUrl) {\r\n      return document.fileUrl;\r\n    }\r\n    // Legacy fallback for old documents\r\n    if (document.filePath) {\r\n      return documentAPI.download(document.filePath);\r\n    }\r\n    return '';\r\n  };\r\n\r\n  const getFileExtension = (document) => {\r\n    // Get extension from fileName (for S3 documents) or filePath (for legacy)\r\n    const filename = document.fileName || document.filePath || '';\r\n    return filename.split('.').pop()?.toLowerCase() || '';\r\n  };\r\n\r\n  const renderDocumentViewer = () => {\r\n    if (!selectedDocument) return null;\r\n\r\n    const fileExtension = getFileExtension(selectedDocument);\r\n    const documentUrl = getDocumentUrl(selectedDocument);\r\n\r\n    // Disable keyboard shortcuts for print/save\r\n    const handleKeyDown = (e) => {\r\n      if (e.ctrlKey && (e.key === 's' || e.key === 'p')) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      }\r\n      if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div \r\n        className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\"\r\n        onKeyDown={handleKeyDown}\r\n        tabIndex={-1}\r\n        style={{ outline: 'none' }}\r\n      >\r\n        <div \r\n          className=\"bg-white rounded-lg shadow-xl w-full h-full max-w-6xl max-h-full flex flex-col\"\r\n          style={{\r\n            WebkitUserSelect: 'none',\r\n            MozUserSelect: 'none',\r\n            msUserSelect: 'none',\r\n            userSelect: 'none'\r\n          }}\r\n        >\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-4 border-b\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <FileText className=\"h-6 w-6 text-blue-600\" />\r\n              <div>\r\n                <h3 className=\"text-lg font-medium text-gray-900\">\r\n                  {selectedDocument.title}\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500\">\r\n                  Uploaded on {new Date(selectedDocument.createdAt).toLocaleDateString()}\r\n                  {selectedDocument.fileSize && (\r\n                    <span className=\"ml-2\">\r\n                       {(selectedDocument.fileSize / 1024 / 1024).toFixed(2)} MB\r\n                    </span>\r\n                  )}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <button\r\n              onClick={closeViewer}\r\n              className=\"p-2 hover:bg-gray-100 rounded-full\"\r\n            >\r\n              <X className=\"h-6 w-6 text-gray-500\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Document Content */}\r\n          <div className=\"flex-1 overflow-hidden\">\r\n            {viewerLoading ? (\r\n              <div className=\"flex items-center justify-center h-full\">\r\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"></div>\r\n                <p className=\"ml-3 text-gray-600\">Loading document...</p>\r\n              </div>\r\n            ) : !documentUrl ? (\r\n              <div className=\"flex items-center justify-center h-full\">\r\n                <div className=\"text-center\">\r\n                  <FileText className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\r\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                    Document not available\r\n                  </h3>\r\n                  <p className=\"text-gray-500\">\r\n                    Unable to load document. Please try again later.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"h-full w-full\">\r\n                {['pdf'].includes(fileExtension) ? (\r\n                  <iframe\r\n                    src={`${documentUrl}#toolbar=0&navpanes=0&scrollbar=1&view=FitH`}\r\n                    className=\"w-full h-full border-0\"\r\n                    title={selectedDocument.title}\r\n                    style={{ \r\n                      userSelect: 'none',\r\n                      WebkitUserSelect: 'none',\r\n                      MozUserSelect: 'none',\r\n                      msUserSelect: 'none'\r\n                    }}\r\n                    onLoad={(e) => {\r\n                      // Disable right-click context menu\r\n                      e.target.contentDocument?.addEventListener('contextmenu', (event) => {\r\n                        event.preventDefault();\r\n                      });\r\n                      // Disable keyboard shortcuts\r\n                      e.target.contentDocument?.addEventListener('keydown', (event) => {\r\n                        if (event.ctrlKey && (event.key === 's' || event.key === 'p')) {\r\n                          event.preventDefault();\r\n                        }\r\n                      });\r\n                    }}\r\n                  />\r\n                ) : ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp'].includes(fileExtension) ? (\r\n                  <div className=\"h-full flex items-center justify-center bg-gray-50 overflow-auto\">\r\n                    <img\r\n                      src={documentUrl}\r\n                      alt={selectedDocument.title}\r\n                      className=\"max-w-full max-h-full object-contain\"\r\n                      style={{ \r\n                        userSelect: 'none',\r\n                        WebkitUserSelect: 'none',\r\n                        MozUserSelect: 'none',\r\n                        msUserSelect: 'none'\r\n                      }}\r\n                      onContextMenu={(e) => e.preventDefault()}\r\n                      draggable={false}\r\n                    />\r\n                  </div>\r\n                ) : ['txt', 'md', 'csv'].includes(fileExtension) ? (\r\n                  <iframe\r\n                    src={documentUrl}\r\n                    className=\"w-full h-full border-0\"\r\n                    title={selectedDocument.title}\r\n                    style={{ \r\n                      userSelect: 'none',\r\n                      WebkitUserSelect: 'none',\r\n                      MozUserSelect: 'none',\r\n                      msUserSelect: 'none'\r\n                    }}\r\n                    onLoad={(e) => {\r\n                      // Disable right-click context menu\r\n                      e.target.contentDocument?.addEventListener('contextmenu', (event) => {\r\n                        event.preventDefault();\r\n                      });\r\n                      // Disable keyboard shortcuts\r\n                      e.target.contentDocument?.addEventListener('keydown', (event) => {\r\n                        if (event.ctrlKey && (event.key === 's' || event.key === 'p')) {\r\n                          event.preventDefault();\r\n                        }\r\n                      });\r\n                    }}\r\n                  />\r\n                ) : ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'].includes(fileExtension) ? (\r\n                  <iframe\r\n                    src={`https://docs.google.com/viewer?url=${encodeURIComponent(documentUrl)}&embedded=true&chrome=false&dov=1`}\r\n                    className=\"w-full h-full border-0\"\r\n                    title={selectedDocument.title}\r\n                    style={{ \r\n                      userSelect: 'none',\r\n                      WebkitUserSelect: 'none',\r\n                      MozUserSelect: 'none',\r\n                      msUserSelect: 'none'\r\n                    }}\r\n                    onLoad={(e) => {\r\n                      // Disable right-click context menu\r\n                      e.target.contentDocument?.addEventListener('contextmenu', (event) => {\r\n                        event.preventDefault();\r\n                      });\r\n                    }}\r\n                  />\r\n                ) : (\r\n                  <div className=\"h-full flex items-center justify-center bg-gray-50\">\r\n                    <div className=\"text-center\">\r\n                      <FileText className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\r\n                      <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                        Preview not available\r\n                      </h3>\r\n                      <p className=\"text-gray-500\">\r\n                        This file type ({fileExtension}) cannot be previewed directly.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const highlightText = (text, searchTerm) => {\r\n    if (!searchTerm) return text;\r\n    \r\n    const parts = text.split(new RegExp(`(${searchTerm})`, 'gi'));\r\n    return parts.map((part, index) => \r\n      part.toLowerCase() === searchTerm.toLowerCase() ? \r\n        <span key={index} className=\"bg-yellow-200 font-semibold\">{part}</span> : \r\n        part\r\n    );\r\n  };\r\n\r\n  const renderCategory = (category, level = 0) => {\r\n    const isExpanded = expandedCategories.has(category._id);\r\n    const hasDocuments = categorizedDocuments[category._id] && categorizedDocuments[category._id].length > 0;\r\n    const hasSubcategories = category.subcategories && category.subcategories.length > 0;\r\n    const hasContent = hasDocuments || hasSubcategories;\r\n    const matchesSearch = searchTerm && category.name.toLowerCase().includes(searchTerm.toLowerCase());\r\n\r\n    return (\r\n      <div key={category._id} className=\"border-l-2 border-gray-200\">\r\n        <div \r\n          className={`flex items-center py-2 px-3 sm:px-4 hover:bg-gray-50 cursor-pointer ${\r\n            matchesSearch ? 'bg-yellow-50' : \r\n            level === 0 ? 'bg-gray-100' : level === 1 ? 'bg-gray-50' : 'bg-white'\r\n          }`}\r\n          style={{ paddingLeft: `${12 + level * 16}px` }}\r\n          onClick={() => hasContent && toggleCategory(category._id)}\r\n        >\r\n          <div className=\"flex items-center space-x-2 flex-1 min-w-0\">\r\n            {hasContent ? (\r\n              isExpanded ? (\r\n                <ChevronDown className=\"h-4 w-4 text-gray-500 flex-shrink-0\" />\r\n              ) : (\r\n                <ChevronRight className=\"h-4 w-4 text-gray-500 flex-shrink-0\" />\r\n              )\r\n            ) : (\r\n              <div className=\"w-4 h-4 flex-shrink-0\" />\r\n            )}\r\n            \r\n            {isExpanded ? (\r\n              <FolderOpen className=\"h-4 w-4 sm:h-5 sm:w-5 text-blue-500 flex-shrink-0\" />\r\n            ) : (\r\n              <Folder className=\"h-4 w-4 sm:h-5 sm:w-5 text-gray-500 flex-shrink-0\" />\r\n            )}\r\n            \r\n            <span className={`font-medium text-sm sm:text-base truncate ${\r\n              level === 0 ? 'text-gray-900' : level === 1 ? 'text-gray-800' : 'text-gray-700'\r\n            }`}>\r\n              {highlightText(category.name, searchTerm)}\r\n            </span>\r\n          </div>\r\n          \r\n          {hasDocuments && (\r\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 flex-shrink-0\">\r\n              {categorizedDocuments[category._id].length}\r\n            </span>\r\n          )}\r\n        </div>\r\n\r\n        {isExpanded && hasContent && (\r\n          <div className=\"ml-4\">\r\n            {/* Render documents for this category */}\r\n            {hasDocuments && (\r\n              <div className=\"space-y-1 mb-2\">\r\n                {categorizedDocuments[category._id].map((document) => (\r\n                  <div \r\n                    key={document._id} \r\n                    className=\"flex items-center justify-between py-2 px-3 sm:px-4 hover:bg-blue-50 rounded-md mx-1 sm:mx-2\"\r\n                    style={{ paddingLeft: `${12 + (level + 1) * 16}px` }}\r\n                  >\r\n                    <div \r\n                      className={`flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0 ${\r\n                        user?.role === 'student' ? 'cursor-pointer hover:bg-blue-100 rounded-md p-1 -m-1 transition-colors' : ''\r\n                      }`}\r\n                      onClick={user?.role === 'student' ? () => handleViewDocument(document) : undefined}\r\n                      title={user?.role === 'student' ? 'Click to view document' : ''}\r\n                    >\r\n                      <FileText className=\"h-4 w-4 text-blue-600 flex-shrink-0\" />\r\n                      <div className=\"min-w-0 flex-1\">\r\n                        <p className={`text-xs sm:text-sm font-medium truncate ${\r\n                          user?.role === 'student' ? 'text-blue-700 hover:text-blue-800' : 'text-blue-600'\r\n                        }`}>\r\n                          {highlightText(document.title, searchTerm)}\r\n                        </p>\r\n                        <p className=\"text-xs text-gray-500 hidden sm:block\">\r\n                          {new Date(document.createdAt).toLocaleDateString()}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-1 sm:space-x-2 flex-shrink-0\">\r\n                      {user?.role === 'student' && (\r\n                        <button\r\n                          onClick={(e) => toggleFavorite(document._id, e)}\r\n                          className=\"p-1 hover:bg-gray-100 rounded-full\"\r\n                          title={userFavorites.has(document._id) ? 'Remove from favorites' : 'Add to favorites'}\r\n                        >\r\n                          <Star \r\n                            className={`h-3 w-3 sm:h-4 sm:w-4 ${\r\n                              userFavorites.has(document._id) \r\n                                ? 'text-yellow-500 fill-yellow-500' \r\n                                : 'text-gray-400 hover:text-yellow-500'\r\n                            }`}\r\n                          />\r\n                        </button>\r\n                      )}\r\n                      {(user?.role === 'admin' || user?.role === 'superadmin') && (\r\n                        <>\r\n                          <button\r\n                            onClick={() => handleViewDocument(document)}\r\n                            className=\"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                          >\r\n                            <Eye className=\"h-3 w-3 mr-1\" />\r\n                            <span className=\"hidden sm:inline\">View</span>\r\n                          </button>\r\n                          <button\r\n                            onClick={(e) => handleDeleteDocument(document._id, document.title, e)}\r\n                            disabled={deleteLoading === document._id}\r\n                            className=\"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            title=\"Delete document\"\r\n                          >\r\n                            {deleteLoading === document._id ? (\r\n                              <div className=\"h-3 w-3 animate-spin rounded-full border border-red-700 border-t-transparent mr-1\"></div>\r\n                            ) : (\r\n                              <Trash2 className=\"h-3 w-3 mr-1\" />\r\n                            )}\r\n                            <span className=\"hidden sm:inline\">\r\n                              {deleteLoading === document._id ? 'Deleting...' : 'Delete'}\r\n                            </span>\r\n                          </button>\r\n                        </>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n\r\n            {/* Render subcategories */}\r\n            {hasSubcategories && (\r\n              <div>\r\n                {category.subcategories.map(subcategory => \r\n                  renderCategory(subcategory, level + 1)\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n\r\n\r\n  const renderUncategorizedDocuments = () => {\r\n    const uncategorizedDocs = categorizedDocuments['uncategorized'];\r\n    if (!uncategorizedDocs || uncategorizedDocs.length === 0) return null;\r\n\r\n    const isExpanded = expandedCategories.has('uncategorized');\r\n\r\n    return (\r\n      <div className=\"border-l-2 border-gray-200\">\r\n        <div \r\n          className=\"flex items-center py-2 px-3 sm:px-4 hover:bg-gray-50 cursor-pointer bg-gray-100\"\r\n          onClick={() => toggleCategory('uncategorized')}\r\n        >\r\n          <div className=\"flex items-center space-x-2 flex-1 min-w-0\">\r\n            {isExpanded ? (\r\n              <ChevronDown className=\"h-4 w-4 text-gray-500 flex-shrink-0\" />\r\n            ) : (\r\n              <ChevronRight className=\"h-4 w-4 text-gray-500 flex-shrink-0\" />\r\n            )}\r\n            \r\n            {isExpanded ? (\r\n              <FolderOpen className=\"h-4 w-4 sm:h-5 sm:w-5 text-gray-500 flex-shrink-0\" />\r\n            ) : (\r\n              <Folder className=\"h-4 w-4 sm:h-5 sm:w-5 text-gray-500 flex-shrink-0\" />\r\n            )}\r\n            \r\n            <span className=\"font-medium text-sm sm:text-base text-gray-900 truncate\">\r\n              Uncategorized\r\n            </span>\r\n          </div>\r\n          \r\n          <span className=\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 flex-shrink-0\">\r\n            {uncategorizedDocs.length}\r\n          </span>\r\n        </div>\r\n\r\n        {isExpanded && (\r\n          <div className=\"ml-4 space-y-1 mb-2\">\r\n            {uncategorizedDocs.map((document) => (\r\n              <div \r\n                key={document._id} \r\n                className=\"flex items-center justify-between py-2 px-3 sm:px-4 hover:bg-blue-50 rounded-md mx-1 sm:mx-2\"\r\n                style={{ paddingLeft: '32px' }}\r\n              >\r\n                <div \r\n                  className={`flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0 ${\r\n                    user?.role === 'student' ? 'cursor-pointer hover:bg-blue-100 rounded-md p-1 -m-1 transition-colors' : ''\r\n                  }`}\r\n                  onClick={user?.role === 'student' ? () => handleViewDocument(document) : undefined}\r\n                  title={user?.role === 'student' ? 'Click to view document' : ''}\r\n                >\r\n                  <FileText className=\"h-4 w-4 text-blue-600 flex-shrink-0\" />\r\n                  <div className=\"min-w-0 flex-1\">\r\n                    <p className={`text-xs sm:text-sm font-medium truncate ${\r\n                      user?.role === 'student' ? 'text-blue-700 hover:text-blue-800' : 'text-blue-600'\r\n                    }`}>\r\n                      {highlightText(document.title, searchTerm)}\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-500 hidden sm:block\">\r\n                      {new Date(document.createdAt).toLocaleDateString()}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-center space-x-1 sm:space-x-2 flex-shrink-0\">\r\n                  {user?.role === 'student' && (\r\n                    <button\r\n                      onClick={(e) => toggleFavorite(document._id, e)}\r\n                      className=\"p-1 hover:bg-gray-100 rounded-full\"\r\n                      title={userFavorites.has(document._id) ? 'Remove from favorites' : 'Add to favorites'}\r\n                    >\r\n                      <Star \r\n                        className={`h-3 w-3 sm:h-4 sm:w-4 ${\r\n                          userFavorites.has(document._id) \r\n                            ? 'text-yellow-500 fill-yellow-500' \r\n                            : 'text-gray-400 hover:text-yellow-500'\r\n                        }`}\r\n                      />\r\n                    </button>\r\n                  )}\r\n                  {(user?.role === 'admin' || user?.role === 'superadmin') && (\r\n                    <>\r\n                      <button\r\n                        onClick={() => handleViewDocument(document)}\r\n                        className=\"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                      >\r\n                        <Eye className=\"h-3 w-3 mr-1\" />\r\n                        <span className=\"hidden sm:inline\">View</span>\r\n                      </button>\r\n                      <button\r\n                        onClick={(e) => handleDeleteDocument(document._id, document.title, e)}\r\n                        disabled={deleteLoading === document._id}\r\n                        className=\"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                        title=\"Delete document\"\r\n                      >\r\n                        {deleteLoading === document._id ? (\r\n                          <div className=\"h-3 w-3 animate-spin rounded-full border border-red-700 border-t-transparent mr-1\"></div>\r\n                        ) : (\r\n                          <Trash2 className=\"h-3 w-3 mr-1\" />\r\n                        )}\r\n                        <span className=\"hidden sm:inline\">\r\n                          {deleteLoading === document._id ? 'Deleting...' : 'Delete'}\r\n                        </span>\r\n                      </button>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const getTotalMatchingDocuments = () => {\r\n    if (!searchTerm) return documents.length;\r\n    \r\n    const searchLower = searchTerm.toLowerCase();\r\n    \r\n    // Documents matching by title\r\n    const matchingDocs = documents.filter(doc =>\r\n      doc.title.toLowerCase().includes(searchLower)\r\n    );\r\n\r\n    // Documents from matching categories\r\n    const matchingCategoryIds = new Set();\r\n    const checkCategory = (cat) => {\r\n      if (cat.name.toLowerCase().includes(searchLower)) {\r\n        matchingCategoryIds.add(cat._id);\r\n      }\r\n      if (cat.subcategories) {\r\n        cat.subcategories.forEach(checkCategory);\r\n      }\r\n    };\r\n    categories.forEach(checkCategory);\r\n\r\n    const docsFromMatchingCategories = documents.filter(doc => \r\n      doc.category && matchingCategoryIds.has(doc.category._id)\r\n    );\r\n\r\n    // Combine and deduplicate\r\n    const allMatchingDocs = [...new Set([...matchingDocs, ...docsFromMatchingCategories])];\r\n    return allMatchingDocs.length;\r\n  };\r\n\r\n  const totalDocuments = getTotalMatchingDocuments();\r\n\r\n  return (\r\n    <div className=\"h-full\">\r\n      {/* Page Header */}\r\n      <div className=\"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between flex-shrink-0\">\r\n        <div>\r\n          <h1 className=\"text-xl font-semibold text-gray-900\">Document Library</h1>\r\n          <p className=\"text-sm text-gray-500 mt-1\">Browse and view documents organized by categories</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content Layout */}\r\n      <div className=\"flex h-full\">\r\n        {/* Categories Section - Always Visible */}\r\n        <div className=\"w-full sm:w-96 lg:w-80 xl:w-96 bg-white border-r border-gray-200 flex flex-col\">{/* Remove the sm:w-96 and change based on screen */}\r\n          \r\n          {/* Sidebar Header */}\r\n          <div className=\"flex items-center justify-between px-3 py-2 border-b border-gray-200 flex-shrink-0\">\r\n            <h2 className=\"text-base font-semibold text-gray-900\">Categories</h2>\r\n            <button\r\n              onClick={() => setSidebarOpen(false)}\r\n              className=\"lg:hidden p-1 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100\"\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Search */}\r\n          <div className=\"p-3 border-b border-gray-200 flex-shrink-0\">\r\n            <div className=\"relative\">\r\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                <Search className=\"h-4 w-4 text-gray-400\" />\r\n              </div>\r\n              <input\r\n                type=\"text\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"focus:ring-blue-500 focus:border-blue-500 block w-full pl-9 py-1.5 text-sm border-gray-300 rounded-md\"\r\n                placeholder=\"Search documents...\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Results Summary */}\r\n          <div className=\"px-3 py-2 border-b border-gray-200 flex-shrink-0\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <p className=\"text-xs text-gray-600\">\r\n                {searchTerm ? \r\n                  `Found ${totalDocuments} docs` : \r\n                  `${totalDocuments} docs`\r\n                }\r\n              </p>\r\n              <div className=\"flex items-center space-x-2\">\r\n                <button\r\n                  onClick={() => setExpandedCategories(new Set())}\r\n                  className=\"text-xs text-gray-500 hover:text-gray-700\"\r\n                >\r\n                  Collapse\r\n                </button>\r\n                <span className=\"text-gray-300\">|</span>\r\n                <button\r\n                  onClick={() => {\r\n                    const allIds = new Set();\r\n                    const addIds = (cats) => {\r\n                      cats.forEach(cat => {\r\n                        if (categorizedDocuments[cat._id] || cat.subcategories?.length > 0) {\r\n                          allIds.add(cat._id);\r\n                        }\r\n                        if (cat.subcategories) {\r\n                          addIds(cat.subcategories);\r\n                        }\r\n                      });\r\n                    };\r\n                    addIds(categoryTree);\r\n                    if (categorizedDocuments['uncategorized']) {\r\n                      allIds.add('uncategorized');\r\n                    }\r\n                    setExpandedCategories(allIds);\r\n                  }}\r\n                  className=\"text-xs text-blue-600 hover:text-blue-800\"\r\n                >\r\n                  Expand\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Category Tree - Scrollable */}\r\n          <div className=\"flex-1 overflow-y-auto sidebar-scroll\">\r\n            {categoryTree.length > 0 || categorizedDocuments['uncategorized'] ? (\r\n              <div className=\"divide-y divide-gray-100\">\r\n                {categoryTree.map(category => renderCategory(category))}\r\n                {renderUncategorizedDocuments()}\r\n              </div>\r\n            ) : (\r\n              <div className=\"flex flex-col items-center justify-center h-full p-4 text-center\">\r\n                <FileText className=\"h-8 w-8 sm:h-12 sm:w-12 text-gray-400 mb-4\" />\r\n                <h3 className=\"text-sm font-medium text-gray-900 mb-2\">No documents found</h3>\r\n                <p className=\"text-xs sm:text-sm text-gray-500\">\r\n                  {searchTerm\r\n                    ? 'Try adjusting your search criteria.'\r\n                    : 'No documents have been uploaded yet.'}\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Overlay for mobile sidebar */}\r\n        {sidebarOpen && (\r\n          <div \r\n            className=\"lg:hidden fixed inset-0 z-40 bg-black bg-opacity-50 transition-opacity duration-300\"\r\n            onClick={() => setSidebarOpen(false)}\r\n            aria-hidden=\"true\"\r\n          />\r\n        )}\r\n\r\n        {/* Main Content Area */}\r\n        <div className=\"flex-1 flex flex-col min-w-0 bg-white\">\r\n          {selectedDocument ? (\r\n            /* Document Viewer */\r\n            <>\r\n              {/* Document Header - Compact */}\r\n              <div className=\"bg-white border-b border-gray-200 px-2 sm:px-4 py-2 flex items-center justify-between flex-shrink-0\">\r\n                <div className=\"flex items-center min-w-0 flex-1\">\r\n                  <button\r\n                    onClick={() => setSelectedDocument(null)}\r\n                    className=\"mr-2 p-1 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100\"\r\n                  >\r\n                    <ArrowLeft className=\"h-4 w-4\" />\r\n                  </button>\r\n                  <div className=\"min-w-0 flex-1\">\r\n                    <h1 className=\"text-sm sm:text-base font-semibold text-gray-900 truncate\">\r\n                      {selectedDocument.title}\r\n                    </h1>\r\n                    <p className=\"text-xs text-gray-500 truncate hidden sm:block\">\r\n                      {selectedDocument.category?.name || 'Uncategorized'}  \r\n                      {new Date(selectedDocument.createdAt).toLocaleDateString()}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-1 ml-2 flex-shrink-0\">\r\n                  {user?.role === 'student' && (\r\n                    <button\r\n                      onClick={() => toggleFavorite(selectedDocument._id)}\r\n                      className=\"p-1 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100\"\r\n                      title={userFavorites.has(selectedDocument._id) ? 'Remove from favorites' : 'Add to favorites'}\r\n                    >\r\n                      <Star \r\n                        className={`h-4 w-4 ${\r\n                          userFavorites.has(selectedDocument._id) \r\n                            ? 'text-yellow-500 fill-yellow-500' \r\n                            : 'text-gray-400 hover:text-yellow-500'\r\n                        }`}\r\n                      />\r\n                    </button>\r\n                  )}\r\n                  {(user?.role === 'admin' || user?.role === 'superadmin') && (\r\n                    <button\r\n                      onClick={() => handleDeleteDocument(selectedDocument._id, selectedDocument.title)}\r\n                      disabled={deleteLoading === selectedDocument._id}\r\n                      className=\"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                      title=\"Delete document\"\r\n                    >\r\n                      {deleteLoading === selectedDocument._id ? (\r\n                        <div className=\"h-3 w-3 animate-spin rounded-full border border-red-700 border-t-transparent mr-1\"></div>\r\n                      ) : (\r\n                        <Trash2 className=\"h-3 w-3 mr-1\" />\r\n                      )}\r\n                      <span className=\"hidden sm:inline\">\r\n                        {deleteLoading === selectedDocument._id ? 'Deleting...' : 'Delete'}\r\n                      </span>\r\n                    </button>\r\n                  )}\r\n                  <button\r\n                    onClick={() => setSelectedDocument(null)}\r\n                    className=\"p-1 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 lg:hidden\"\r\n                  >\r\n                    <X className=\"h-4 w-4\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Document Content - Full Height */}\r\n              <div className=\"flex-1 min-h-0\">\r\n                {viewerLoading ? (\r\n                  <div className=\"flex items-center justify-center h-full bg-gray-50\">\r\n                    <div className=\"text-center\">\r\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto\"></div>\r\n                      <p className=\"mt-2 text-sm text-gray-500\">Loading document...</p>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <iframe\r\n                    src={selectedDocument.downloadUrl}\r\n                    className=\"w-full h-full border-0 bg-white\"\r\n                    title={selectedDocument.title}\r\n                    style={{ minHeight: '100%' }}\r\n                  />\r\n                )}\r\n              </div>\r\n            </>\r\n          ) : (\r\n            /* Welcome Screen */\r\n            <div className=\"flex-1 flex items-center justify-center bg-gray-50 p-4\">\r\n              <div className=\"text-center max-w-md\">\r\n                <FileText className=\"mx-auto h-12 w-12 sm:h-16 sm:w-16 text-gray-400 mb-4\" />\r\n                <h2 className=\"text-lg sm:text-xl font-semibold text-gray-900 mb-2\">Document Library</h2>\r\n                <p className=\"text-sm sm:text-base text-gray-600 mb-6\">\r\n                  Browse and view documents organized by categories.\r\n                </p>\r\n                \r\n                {/* Mobile instruction */}\r\n                <div className=\"lg:hidden\">\r\n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">\r\n                    <p className=\"text-sm text-blue-800 mb-3\">\r\n                      Tap the menu button above to browse categories and documents\r\n                    </p>\r\n                    <div className=\"flex items-center justify-center\">\r\n                      <Menu className=\"h-5 w-5 text-blue-600 mr-2\" />\r\n                      <span className=\"text-sm font-medium text-blue-600\">Categories Menu</span>\r\n                    </div>\r\n                  </div>\r\n                  <button\r\n                    onClick={() => setSidebarOpen(true)}\r\n                    className=\"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 shadow-sm\"\r\n                  >\r\n                    <Menu className=\"h-5 w-5 mr-2\" />\r\n                    Browse Documents\r\n                  </button>\r\n                </div>\r\n                \r\n                {/* Desktop instruction */}\r\n                <p className=\"hidden lg:block text-sm text-gray-500\">\r\n                  Select a document from the sidebar to view it here.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Documents; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}